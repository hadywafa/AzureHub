# ğŸ§‘â€âœˆï¸ Microsoft Entra ID RBAC

> **ğŸ“– Microsoft Entra ID RBAC** is the Role-Based Access Control system used to manage **access to identity-related resources** inside your **Microsoft Entra tenant** (formerly Azure AD).

ğŸ’¡ Think of this as **IAM for identity services** â€” managing users, groups, roles, apps, and policies, **not VMs or storage accounts**.

| Azure RBAC             | Entra ID RBAC                           |
| ---------------------- | --------------------------------------- |
| Controls **resources** | Controls **directory & identity tasks** |
| Used for VMs, Storage  | Used for Users, Groups, Apps, Policies  |
| Scopes: Subscription+  | Scope: Entire Tenant                    |

---

<div align="center">
  <img src="images/entra-id-rbac.png" alt="entra-id-rbac" style="width: 80%; border-radius: 10px;">
</div>

---

## ğŸ¢ Scope of Entra RBAC

Unlike Azure RBAC, which works at **multi-level scope** (Sub â†’ RG â†’ Resource), **Entra ID RBAC is flat** â€” it applies to the **entire tenant**.

You **canâ€™t assign Entra roles per-resource** like Azure RBAC.

---

## ğŸ§© Key Concepts

| Concept                   | Description                                                                                                                                                        |
| ------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **1ï¸âƒ£ Role Definition**    | A predefined set of directory-level, can be **built-in** or **custom** roles.                                                                                      |
| **2ï¸âƒ£ Security Principal** | Supports the following: </br> 1. **User identity**</br> 2. **Security group ( requires P1 license)**</br> 3. **Application Identity**</br> 4. **Managed Identity** |
| **3ï¸âƒ£ Scope**              | Supports the following: </br> 1. **Tenant/Directory** </br> 2. **Administrative Unit**                                                                             |

> ğŸ“Œ **Assignment:** Binding between role and principal and can be:

---

## ğŸ­ Built-in Entra ID Roles (a few important ones)

| Role                        | What It Can Do                                            |
| --------------------------- | --------------------------------------------------------- |
| **Global Administrator**    | Full access to all Entra resources and Microsoft services |
| **User Administrator**      | Manage users and groups (create, delete, reset passwords) |
| **Groups Administrator**    | Create, update, delete groups                             |
| **Cloud App Administrator** | Manage enterprise apps and assign users                   |
| **Security Reader**         | Read-only access to security alerts and policies          |
| **Privileged Role Admin**   | Manage role assignments (PIM and others)                  |

ğŸ” These roles are not for resource access â€” they donâ€™t grant access to Azure VMs or Storage.

---

## ğŸ§ª Example: Helpdesk Needs to Reset Passwords

```yaml
- Identity: helpdesk@company.com
- Role: User Administrator
- Scope: Entire Tenant
```

âœ… Can reset user passwords  
âŒ Cannot delete a VM  
âŒ Cannot view billing data unless given Azure RBAC permission

---

## ğŸ§± How Roles Are Assigned in Entra

### ğŸ‘¨â€ğŸ’» Via Microsoft Entra Admin Center:

1. Go to **entra.microsoft.com**
2. Navigate to **Identity > Roles & Administrators**
3. Pick a role (e.g., "User Administrator")
4. Click **+ Add assignment**
5. Choose a **user, group**, or **service principal**

---

### ğŸ§‘â€ğŸ¤â€ğŸ§‘ Assign to Groups = Dynamic Delegation

âœ… You can assign roles to **groups** so everyone in that group inherits the role  
ğŸ”„ Supports **dynamic groups** (e.g., all users in HR)

---

## ğŸ’ Privileged Identity Management (PIM)

PIM allows you to make **Entra RBAC temporary** or **just-in-time**:

- ğŸ”„ Require approval to activate role
- â± Limit duration (e.g., 2 hours)
- ğŸ“¬ Send alerts on activation
- âœ… Record audit trail

ğŸ›¡ Great for **least privilege**, **zero standing access**, and **auditing compliance**

---

## ğŸ§  Entra Role Evaluation Workflow

```mermaid
flowchart TD
    A[User signs in] --> B[Token issued by Entra ID]
    B --> C[Evaluate role assignments]
    C -->|Yes| D[Add role claims to token]
    D --> E[Allow access to Entra feature (e.g. reset password)]
    C -->|No| F[Block access to admin portal]
```

ğŸ’¡ Role **claims are embedded in the token** at sign-in!

---

## ğŸ§© Service Principals & App Access

You can assign Entra roles to:

- Service Principals (App Registrations)
- Managed Identities (for directory access)

Example: App needs to read Entra users â†’ assign `Directory Reader` to the app.

---

## ğŸš« Entra Roles Do Not = Azure Permissions

| Role Name                      | Grants Azure Access? | Grants Tenant Access? | Notes                                 |
| ------------------------------ | -------------------- | --------------------- | ------------------------------------- |
| Global Administrator           | âŒ (Not by default)  | âœ…                    | Can manage identity, not VMs          |
| Contributor (Azure RBAC)       | âœ…                   | âŒ                    | Can manage Azure resources, not users |
| User Access Admin (Azure RBAC) | âœ…                   | âŒ                    | Can manage Azure RBAC, not Entra      |

ğŸ§  The only way to **manage Azure resources** is through **Azure RBAC**!

---

## ğŸ†š Entra RBAC vs Application RBAC vs Azure RBAC

| Type           | Scope          | Grants Access To            | Example                  |
| -------------- | -------------- | --------------------------- | ------------------------ |
| **Azure RBAC** | Resource Plane | Azure resources             | VMs, storage, networking |
| **Entra RBAC** | Identity Plane | Directory/identity features | Users, groups, roles     |
| **App RBAC**   | Application    | App-specific roles (custom) | "Admin" inside SaaS app  |

---

## ğŸ“Œ Summary

- Microsoft Entra ID RBAC governs **identity-level actions**, not Azure resources.
- Itâ€™s scoped at the **tenant level**, not per subscription or resource.
- Use **built-in roles** for users, apps, and admins.
- Combine with **PIM** for secure, temporary elevation.
- For Azure resource access, use **Azure RBAC** (totally separate system).
