# ğŸ› ï¸ **Creating & Using App Registration + Enterprise Application in Entra ID**

## ğŸ“Œ **1. Create an App Registration (Developer Step)**

ğŸ‘‰ This is done in **Entra ID â†’ App registrations**.

Steps:

1. Go to **Azure Portal â†’ Microsoft Entra ID â†’ App registrations**
2. Click **New registration**
3. Fill details:

   - **Name**: `MyWebApp`
   - **Supported account types**:

     - Single tenant (only your org)
     - Multi-tenant (other orgs too)

   - **Redirect URI** (if itâ€™s a web/app) â†’ e.g., `https://localhost:5001/signin-oidc`

4. Click **Register** âœ…

ğŸ”‘ At this point:

- Entra creates an **Application Object** (blueprint).
- You get:

  - **Client ID** (App ID)
  - **Tenant ID**
  - **Directory permissions** (like Graph API scopes).

---

## ğŸ“Œ **2. Enterprise Application (Admin Step)**

- When you create an **App Registration**, Entra automatically makes an **Enterprise Application** in the same tenant.
- Youâ€™ll see it in **Entra ID â†’ Enterprise Applications**.

ğŸ‘‰ Enterprise Application = **local instance** of the app in your org.

Here you can:

- Assign **users/groups** who can sign in.
- Apply **Conditional Access** policies (MFA, block risky logins).
- Control **who sees this app in MyApps portal**.

ğŸ’¡ If you connect a **third-party SaaS** (e.g., Salesforce, ServiceNow) â†’ you donâ€™t create an App Registration. Instead, the SaaS vendor provides it â†’ your tenant only gets an **Enterprise Application**.

---

## ğŸ“Œ **3. Service Principal (Behind the Scenes)**

When the Enterprise Application is created â†’ Entra also creates a **Service Principal**.

- This is the **identity record** used by the app to authenticate.
- If your app needs to call Azure APIs (like Key Vault, Storage, Graph), youâ€™ll generate:

  - A **Client Secret** (like a password)
  - Or a **Certificate** (safer ğŸ”)

---

## ğŸ“Œ **4. Usage Scenarios**

### ğŸ”¹ **Scenario A: Custom App**

- You build an **Angular + .NET API app**.
- Register it in **App registrations**.
- Enterprise App auto-created â†’ assign your employees.
- App uses **Client ID + Secret** to authenticate against Entra ID.
- Users log in â†’ Entra issues JWT tokens.

---

### ğŸ”¹ **Scenario B: Automation (Pipeline, Terraform, CLI)**

- You create an **App Registration** named `AzurePipelineSP`.
- Enterprise App + Service Principal auto-created.
- Give it RBAC role (e.g., Contributor) on subscription.
- In your pipeline, use **Client ID + Secret** to authenticate â†’ deploy resources.

---

### ğŸ”¹ **Scenario C: SaaS Integration (Salesforce)**

- Add Salesforce from **Enterprise Applications Gallery**.
- Only an **Enterprise Application** shows up (no custom App Registration).
- Assign users/groups to it.
- They now log in with their Microsoft Entra ID SSO.

---

## ğŸ“Œ **5. Visual Flow**

<div align="center">

```mermaid
flowchart TD
    subgraph Dev["Developer Action"]
        AR["App Registration<br>(Blueprint)"]
    end
    subgraph Tenant["Tenant Instance"]
        EA["Enterprise Application<br>(Local copy in org)"]
        SP["Service Principal<br>(Identity used to log in)"]
    end

    AR --> EA --> SP
```

</div>

---

## ğŸ“Œ **6. Quick Checklist**

- âœ… **App Registration** â†’ for developers (blueprint: Client ID, Redirect URI, Permissions).
- âœ… **Enterprise Application** â†’ for admins (assign users, apply policies, monitor usage).
- âœ… **Service Principal** â†’ the actual robot identity behind the app, used for auth.
- âœ… **Usage**:

  - Custom app â†’ Register app
  - Automation â†’ Create SP via registration
  - SaaS â†’ Add from Enterprise Apps gallery

---

## ğŸ **TL;DR**

- **Create App Registration** â†’ defines app globally (Client ID, permissions).
- **Enterprise Application auto-created** â†’ local copy in your tenant for assigning users/policies.
- **Service Principal** â†’ identity behind the Enterprise App used for authentication.
- **Usage depends**:

  - Build apps â†’ register
  - Pipelines/scripts â†’ use SP creds
  - SaaS apps â†’ only Enterprise App needed
