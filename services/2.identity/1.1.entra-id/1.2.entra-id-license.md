# ğŸ’³ **What is Microsoft Entra ID Licensing?**

- **Microsoft Entra ID (formerly Azure AD)** comes in **different editions** (Free, P1, P2).
- Each edition unlocks certain **identity and security features**.
- Licenses are assigned to **users**, not to groups of devices.
- Without the correct license, certain premium features wonâ€™t work for that user.

ğŸ‘‰ Licensing is **per user**. If one user needs Conditional Access, that user must have at least **P1**.

---

<div align="center">
  <img src="images/entra-id-3.jpg" alt="alt text" style="width: 100%; border-radius: 10px;border: solid 4px">
</div>

---

## ğŸ“¦ **Entra ID License Types**

| Edition                       | Cost                                             | Key Features                                                                                                                          | When to Use                                                    |
| ----------------------------- | ------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------- |
| **Free**                      | Included with Azure subscription / Microsoft 365 | Basic identity services, user & group management, device registration, SSO for up to 10 apps                                          | Small businesses, test labs                                    |
| **Office/Microsoft 365 Apps** | Comes with M365 Business/E3/E5                   | Includes Free tier + self-service password reset for cloud users                                                                      | M365 orgs that donâ€™t need full enterprise IAM                  |
| **P1 (Premium Plan 1)**       | \$\$                                             | Conditional Access, Group-based licensing, Hybrid identities (on-prem sync), MFA for conditional policies, Identity governance basics | Enterprises needing **access policies** and hybrid integration |
| **P2 (Premium Plan 2)**       | \$\$\$                                           | All P1 + Identity Protection (risk-based policies), Privileged Identity Management (PIM), Access Reviews, Entitlement Management      | Enterprises with **advanced security & governance** needs      |

---

| Feature                                                | Microsoft Entra ID Free - Security defaults (enabled for all users) | Microsoft Entra ID Free - Global Administrators only    | Office 365 | Microsoft Entra ID P1 | Microsoft Entra ID P2 |
| ------------------------------------------------------ | ------------------------------------------------------------------- | ------------------------------------------------------- | ---------- | --------------------- | --------------------- |
| Protect Microsoft Entra tenant admin accounts with MFA | âœ…                                                                  | âœ… (Microsoft Entra Global Administrator accounts only) | âœ…         | âœ…                    | âœ…                    |
| Mobile app as a second factor                          | âœ…                                                                  | âœ…                                                      | âœ…         | âœ…                    | âœ…                    |
| Phone call as a second factor                          |                                                                     |                                                         | âœ…         | âœ…                    | âœ…                    |
| SMS as a second factor                                 |                                                                     | âœ…                                                      | âœ…         | âœ…                    | âœ…                    |
| Admin control over verification methods                |                                                                     | âœ…                                                      | âœ…         | âœ…                    | âœ…                    |
| Fraud alert                                            |                                                                     |                                                         |            | âœ…                    | âœ…                    |
| MFA Reports                                            |                                                                     |                                                         |            | âœ…                    | âœ…                    |
| Custom greetings for phone calls                       |                                                                     |                                                         |            | âœ…                    | âœ…                    |
| Custom caller ID for phone calls                       |                                                                     |                                                         |            | âœ…                    | âœ…                    |
| Trusted IPs                                            |                                                                     |                                                         |            | âœ…                    | âœ…                    |
| Remember MFA for trusted devices                       |                                                                     | âœ…                                                      | âœ…         | âœ…                    | âœ…                    |
| MFA for on-premises applications                       |                                                                     |                                                         |            | âœ…                    | âœ…                    |
| Conditional Access                                     |                                                                     |                                                         |            | âœ…                    | âœ…                    |
| Risk-based Conditional Access                          |                                                                     |                                                         |            |                       | âœ…                    |
| Self-service password reset (SSPR)                     | âœ…                                                                  | âœ…                                                      | âœ…         | âœ…                    | âœ…                    |
| SSPR with writeback                                    |                                                                     |                                                         |            | âœ…                    | âœ…                    |

---

## ğŸ§¾ **How Entra ID Licensing Works**

- **Licenses are not shared across the tenant.**
- You **must assign a license to every user** that consumes a feature.
- Example: **Conditional Access = P1 feature.**

  - If you want 1,000 users protected by Conditional Access â†’ you need **1,000 P1 licenses**.
  - Buying just 1 P1 license for the tenant does **not** unlock Conditional Access for everyone.

ğŸ‘‰ Think of it like **Netflix accounts**:

- If you buy **1 Netflix subscription**, only you can watch.
- If 5 people want to watch at the same time â†’ you need **5 licenses** (or a family plan).
  Same in Entra ID.

---

## ğŸ”‘ **Admin vs Users (Big Misconception)**

- Being a **Global Administrator** does not automatically give your tenant all features.
- Your **admin account needs a P1/P2 license too** if you want to use premium features (like configuring Conditional Access policies).
- Licenses must be assigned to **every user** who:

  - Needs Conditional Access evaluation.
  - Needs Identity Protection (P2).
  - Needs Privileged Identity Management (P2).
  - Needs SSPR with writeback (P1+).

---

## ğŸ’­ **Example**: Conditional Access for 1,000 Users

- Scenario: You want **all 1,000 employees** to be forced into MFA when accessing M365.
- **Licenses required:** 1,000 Ã— Entra ID P1.
- Without a license assigned, the Conditional Access policy wonâ€™t apply to that user.
- If you only buy **100 licenses** â†’ you can only cover **100 users** (and must decide who gets them).

---

## âš–ï¸ **Feature Comparison (Cheat Sheet)**

### âœ… **Free**

- Directory objects (users, groups, devices)
- Self-service password reset (**cloud-only users**)
- Basic security (no Conditional Access)
- SSO for 10 SaaS apps

### âœ… **P1**

- All Free features +
- **Conditional Access** (if user from location X â†’ MFA required)
- Group-based licensing
- Hybrid identity with Microsoft Entra Connect (AD â†’ Entra sync)
- Self-service password reset with writeback
- Dynamic groups
- Identity governance basics

### âœ… **P2**

- All P1 features +
- **Identity Protection** (risk-based sign-ins, leaked credentials detection)
- **Privileged Identity Management (PIM)** â†’ Just-in-time admin access
- **Access Reviews** â†’ Periodic access checkups
- **Entitlement Management** â†’ Automate access packages & approvals

---

## ğŸ› ï¸ **License Assignment Methods**

1. **Direct assignment** â†’ assign license to each user individually.

   - Flexible, but hard to manage at scale.

2. **Group-based licensing (P1 or P2 required)** â†’ assign license to a group, users inherit it.

   - Best for large orgs.

3. **Mixed assignment** â†’ some licenses from group, some direct.

ğŸ“Œ Important: If a user belongs to multiple licensed groups, they just get **one license**.

---

## âš ï¸ **Common Errors (Exam Traps)**

1. **Usage Location Not Set**

   - Must be set in user profile before license assignment.
   - Fix: Go to **User â†’ Profile â†’ Usage Location â†’ set (e.g., United States)**.

2. **Not Enough Licenses Available**

   - If you only bought 100 P1 licenses and try to assign to 101 users â†’ fails.

3. **Feature Misunderstanding**

   - E.g., You want Identity Protection â†’ but thatâ€™s **P2 only**, not P1.

---

## ğŸ“Š **Example Scenarios (Exam-Style)**

**Q:** You want to enable **Conditional Access** for HR users. Which license is needed?  
ğŸ‘‰ **P1**

**Q:** You want to require MFA only for risky sign-ins. Which license is needed?  
ğŸ‘‰ **P2** (Identity Protection)

**Q:** You want just-in-time (JIT) admin roles. Which license is needed?  
ğŸ‘‰ **P2** (PIM)

**Q:** You want to automate license assignment to all Finance department users.  
ğŸ‘‰ Use **Group-based licensing (P1+)**

---

## âœ… Features Covered by Tenant (No Per-User License Needed)

There _are some exceptions_.

- **Free features** (basic directory, user management, SSO for 10 apps) apply tenant-wide.
- **Security Defaults** (enforce MFA for all admins) â†’ available for everyone without P1/P2.
- But **premium features (Conditional Access, PIM, Identity Protection)** are **licensed per-user**.

---

## ğŸ§  Easy Rule to Memorize

- **Free features** = tenant-wide.
- **Premium features (P1/P2)** = **per user license**.
- If the feature **affects the userâ€™s sign-in or permissions**, that user needs a license.

---

## ğŸš€ AWS vs Azure Analogy

- In **AWS IAM**, if you enable MFA or an SCP at the **account level**, it applies to **all users** immediately. âœ…
- In **Azure Entra ID**, enabling Conditional Access is like saying: _â€œIâ€™ll enforce MFA only for users who have the right ticket (license).â€_ Each user must have their own ticket. ğŸŸï¸

---

## ğŸ“ Notes to Memorize

- **Free = basics only** (no Conditional Access, no PIM).
- **P1 = Conditional Access + Hybrid identity** (most orgs use this).
- **P2 = advanced security (PIM, Identity Protection, Access Reviews)**.
- **Usage Location must be set** before assigning any license.
- **Licenses are per user** â€” features apply only if user has the license.
- **Group-based licensing requires P1 or P2**.

---

## ğŸ“š Docs to Study

1. ğŸ”— [Microsoft Entra ID editions](https://learn.microsoft.com/en-us/entra/fundamentals/whatis#compare-editions)
2. ğŸ”— [License requirements for Conditional Access](https://learn.microsoft.com/en-us/entra/identity/conditional-access/licensing-conditional-access)
3. ğŸ”— [Assign or remove licenses in Entra ID](https://learn.microsoft.com/en-us/entra/fundamentals/license-users-groups)
4. ğŸ”— [Microsoft Entra licensing overview](https://learn.microsoft.com/en-us/entra/fundamentals/licensing)
5. ğŸ”— [PIM in Entra ID](https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure)
6. ğŸ”— [Identity Protection in Entra ID](https://learn.microsoft.com/en-us/entra/id-protection/overview-identity-protection)

---

## âš¡ My advice for you:

- For **exam prep**, focus on differences between **Free, P1, P2**.
- For **real world**, practice assigning licenses in the portal:

  - Add a new user
  - Leave usage location blank â†’ see error
  - Fix by setting usage location
  - Assign P1 â†’ try Conditional Access
  - Assign P2 â†’ try Identity Protection or PIM.

---

## â“ Question Context

You try to assign a **Microsoft Entra ID P2 license** (e.g., Azure AD Premium P2) to a user. You get an **error**. Why?

---

<div align="left">
  <img src="images/entra-license-usage-location.png" alt="Microsoft Entra ID license usage location" style="width: 50%; border-radius: 10px; border: 2px solid">
</div>

---

### âœ… Correct Answer

ğŸ‘‰ **From the userâ€™s profile section, modify the usage location.**

---

### ğŸ¤” Why This Happens

- Microsoft Entra ID (Azure AD) licensing depends on the **userâ€™s usage location**, not just their country or tenant.
- By default, when you create a new user in Entra ID, their **Usage location field = â€œNoneâ€**.
- If that field is blank, you **cannot assign licenses** (like P1, P2, M365 E5, etc.) because Microsoft enforces licensing availability by region.
- Once you set the usage location (e.g., United States, Canada, etc.), the license assignment succeeds.

---

### âŒ Why the Other Option Is Wrong

- **From the directory blade, modify the directory role**

  - Directory roles (like _Global Administrator_, _User Administrator_) control **permissions**, not license assignment.
  - Even a Global Admin cannot bypass the **usage location requirement**.
  - So this has nothing to do with the error.

---

### ğŸ“ Exam Tip

- Always check if the user has **Usage location set** before assigning a license.
- Without it, youâ€™ll get errors like:
  _â€œLicense assignment failed. The user does not have a usage location specified.â€_
