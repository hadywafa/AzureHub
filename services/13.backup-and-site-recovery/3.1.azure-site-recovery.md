# ðŸŒ **Azure Site Recovery (ASR)** â€“ Disaster Recovery as a Service

> ðŸ“– **Official Definition:**  
> _Azure Site Recovery is a Disaster Recovery as a Service (DRaaS) that keeps your business apps and workloads online by replicating them from a primary site to a secondary site (Azure or another datacenter)._

---

**ðŸ§© In simple words:**

- **Replication**: Your VM/app/server is constantly mirrored into Azure.
- **Failover**: If your primary site dies (fire, power loss, ransomware), you can spin up the replica instantly in Azure.
- **Failback**: When the main site is fixed, move workloads back safely.

---

<div align="center">
  <img src="images/azure-site-recovery-features.png" alt="Azure Site Recovery Features" style="width: 100%; border-radius: 10px; border: 2px solid white;">
</div>

---

## ðŸ› ï¸ **How ASR Works** (The Flow)

```mermaid
---
config:
  layout: elk
  elk:
    mergeEdges: false
---
flowchart LR
    A[Primary Site - On-Prem/Primary Azure Region] -->|Continuous Replication| B[(Recovery Services Vault)]
    B --> C[Secondary Site in Azure - DR Region]
    C -->|Failover Trigger| D[Apps & Services Running in Azure]
    D -->|Failback| A
```

---

1. **Replication** â†’ Continuous sync of workloads (VMs, physical servers, Azure VMs).
2. **Recovery Services Vault** â†’ Stores replication metadata, recovery points, and policies.
3. **Failover** â†’ Trigger DR plan â†’ workloads spin up in Azure (near-zero downtime).
4. **Failback** â†’ Sync back to the primary site once itâ€™s healthy again.

---

<div align="center">
  <img src="images/asr.png" alt="Azure Site Recovery (ASR) - Disaster Recovery as a Service" style="width: 100%; border-radius: 10px; border: 2px solid white;margin:0 20px;">
</div>

---

## âš¡ **RPO & RTO** (Key DR Metrics)

- **RPO (Recovery Point Objective)** â†’ _How much data you can afford to lose._

  - With ASR: **as low as 30 seconds** for supported workloads.

- **RTO (Recovery Time Objective)** â†’ _How quickly you can bring workloads back._

  - With ASR: **minutes** instead of hours/days.

ðŸ‘‰ This is why ASR is chosen for **mission-critical apps**.

---

## ðŸ–¥ï¸ **Supported Workloads**

âœ… **Azure VMs** â€“ Replicate across regions (e.g., East US â†’ Central US).  
âœ… **VMware VMs** â€“ On-prem VMware replicated to Azure.  
âœ… **Hyper-V VMs** â€“ Native Hyper-V integration.  
âœ… **Physical Servers** â€“ Windows/Linux servers on-prem.

âŒ **Not for backups** â€“ Thatâ€™s Azure Backupâ€™s job.  
âŒ **Not for dev snapshots** â€“ Itâ€™s designed for DR continuity, not short-term testing.

---

## âœ¨ **Key Features of ASR**

1. **Multi-platform Replication** â†’ VMware, Hyper-V, Azure, physical servers.
2. **Recovery Plans** â†’ Orchestrate failovers (e.g., start SQL first, then Web App, then Load Balancer).
3. **Test Failovers** â†’ Run DR drills without downtime.
4. **App-consistent Snapshots** â†’ Ensure DBs (SQL, MySQL, Oracle) are usable after recovery.
5. **Integration** â†’ Azure Monitor (alerts), Azure Automation (runbooks), ITSM tools.
6. **Security** â†’ Encrypted replication (in-transit + at rest).
7. **Cost Efficient** â†’ You only pay for storage until you failover (compute billed only when running in Azure).

---

## ðŸ’­ **Use Cases**

- **ðŸ›¡ï¸ Disaster Recovery (Primary Use)**

  - Protect against **natural disasters, hardware failure, power outage, ransomware**.

- **ðŸ”„ Migration**

  - Move workloads from **on-prem â†’ Azure** seamlessly.

- **ðŸ§ª Testing / DevOps**

  - Run failover drills before production releases.

- **ðŸŒ Compliance**

  - Achieve RPO/RTO regulatory requirements (financial, healthcare, government).

---

## âš–ï¸ **Azure Backup** vs **Azure Site Recovery**

| Feature      | **Azure Backup** ðŸ—„ï¸                 | **Azure Site Recovery** ðŸŒ            |
| ------------ | ----------------------------------- | ------------------------------------- |
| **Purpose**  | Protect data (files, VMs, DBs)      | Keep apps running (full workloads)    |
| **Scenario** | Data recovery (long-term retention) | Disaster recovery (continuity)        |
| **Recovery** | Restore after outage                | Continue running during outage        |
| **RPO/RTO**  | Hours â†’ Days                        | Minutes                               |
| **Cost**     | Storage + Retention                 | Storage + Compute (on failover)       |
| **Best For** | File recovery, database backups     | Business continuity, DR orchestration |

ðŸ‘‰ **They complement each other**:

- **Azure Backup** â†’ insurance for files & DBs.
- **ASR** â†’ insurance for entire business apps.

---

## âœðŸ» **Hands-On Example:** Protecting an Azure VM (Region-to-Region DR)

### 1ï¸âƒ£ Step 1 â€“ Create a Recovery Services Vault

**Portal:**

- Search â†’ _Recovery Services Vault_ â†’ Create â†’ Select RG + Region.

**CLI:**

```bash
az backup vault create \
  --resource-group MyRG \
  --name MyRecoveryVault \
  --location eastus
```

---

### 2ï¸âƒ£ Step 2 â€“ Enable Replication for VM

**Portal:**

- Go to **Vault â†’ Site Recovery â†’ Replicate**.
- Choose **Source** (Azure VM) â†’ Select target region â†’ Configure policy.

**CLI:**

```bash
az site-recovery replication-protected-item create \
  --vault-name MyRecoveryVault \
  --resource-group MyRG \
  --protection-container MyContainer \
  --name MyVMReplication \
  --policy-name DefaultPolicy
```

---

### 3ï¸âƒ£ Step 3 â€“ Test Failover

- Go to **Vault â†’ Replicated Items â†’ MyVM â†’ Test Failover**.
- Choose recovery point â†’ Start â†’ VM spins up in DR region without impacting prod.

---

### 4ï¸âƒ£ Step 4 â€“ Planned Failover (Disaster Scenario)

- Vault â†’ _Replicated Items_ â†’ Failover â†’ Confirm.
- VM starts in **secondary region**.
- Update DNS/Traffic Manager â†’ users routed to DR VM.

---

### 5ï¸âƒ£ Step 5 â€“ Failback

- After primary site is back â†’ Run **Failback**.
- Workloads synced back â†’ secondary site freed.

---

## ðŸ **Summary**

- **Azure Site Recovery (ASR)** = _Business Continuity as a Service_.
- Provides **replication, failover, failback** for apps running on-prem or Azure.
- Supports **VMware, Hyper-V, Physical Servers, Azure VMs**.
- **RPO: \~30 sec | RTO: minutes** â†’ near real-time DR.
- Complements **Azure Backup** (data retention).
- Critical for **mission-critical workloads** with compliance & uptime needs.

> ðŸ‘‰ Best practice:
>
> - Use **Azure Backup** for data retention.
> - Use **ASR** for disaster recovery & business continuity.
