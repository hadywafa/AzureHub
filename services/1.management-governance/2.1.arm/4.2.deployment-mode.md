# üöÄ Deployment Modes in ARM Templates

When you deploy an ARM (or Bicep) template, you must choose a **deployment mode**. This determines how Azure handles **existing resources** in the target **Resource Group / Subscription / Management Group / Tenant**.

There are **two modes**:

---

## 1Ô∏è‚É£ **Incremental Mode (default)**

- **Command (Azure CLI / PowerShell)**

  ```bash
  az deployment group create \
    --resource-group myRG \
    --template-file main.json \
    --mode Incremental
  ```

  Or in PowerShell:

  ```powershell
  New-AzResourceGroupDeployment -ResourceGroupName "myRG" `
    -TemplateFile .\main.json -Mode Incremental
  ```

- **How it works**:

  - Adds resources defined in the template **without affecting existing ones**.
  - If a resource already exists and is defined in the template, ARM updates it.
  - Resources **not in the template** remain untouched.

- **Use Case**:

  - When you want to **safely add/update** resources without risk of deleting others.
  - Example: Deploying a new storage account to a resource group that already has networking resources.

---

## 2Ô∏è‚É£ **Complete Mode**

- **Command**

  ```bash
  az deployment group create \
    --resource-group myRG \
    --template-file main.json \
    --mode Complete
  ```

- **How it works**:

  - Azure **makes the resource group match the template exactly**.
  - Any resource **not defined in the template** is **deleted**.
  - Updates existing resources if they are defined in the template.

- **Use Case**:

  - For **drift control** (making sure the environment looks _exactly_ like the template).
  - Useful in **production scenarios** where strict consistency is required.
  - Example: Enforcing a resource group to have only approved VMs, storage accounts, and nothing extra.

---

## üîë Key Differences

| Feature                            | Incremental Mode   | Complete Mode                        |
| ---------------------------------- | ------------------ | ------------------------------------ |
| Default?                           | ‚úÖ Yes             | ‚ùå No                                |
| Adds new resources?                | ‚úÖ Yes             | ‚úÖ Yes                               |
| Updates existing resources?        | ‚úÖ Yes             | ‚úÖ Yes                               |
| Deletes resources not in template? | ‚ùå No              | ‚úÖ Yes                               |
| Risk of unintended deletion?       | ‚ùå Low             | ‚ö†Ô∏è High                              |
| Best suited for                    | Day-to-day updates | Strict enforcement, drift correction |

---

## ‚ö†Ô∏è Important Considerations

- **Complete mode is dangerous** if you forget to include a resource in your template ‚Üí Azure will delete it.
- Use **Incremental** for most dev/test/prod deployments unless you specifically need **strict control**.
- In CI/CD pipelines:

  - Use **Incremental** for safe rollouts.
  - Use **Complete** when you want "template as the source of truth."

---

## ‚úÖ **Best Practice**:

- For **production**: start with **Incremental** to avoid accidental deletions.
- For **governed environments** (like with Landing Zones / compliance): use **Complete mode** but carefully validate templates.
