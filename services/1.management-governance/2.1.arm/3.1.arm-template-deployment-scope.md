# 🔭 Deployment Scopes in ARM Templates

Azure allows you to **deploy resources** at different scopes depending on **what you’re creating** and **who should “own” it**.
The four major scopes are:

1. **Resource Group (most common)**
2. **Subscription**
3. **Management Group**
4. **Tenant**

---

## 1️⃣ Resource Group Scope

👉 **Default / Most common**

- **Where the resources go:** Into a _single resource group_.
- **Deployment command:**

  - CLI → `az deployment group create`
  - PS → `New-AzResourceGroupDeployment`

- **Typical resources deployed here:**

  - Virtual machines, storage accounts, VNets, app services, etc.

- **When to use:**

  - Standard workload deployments.
  - Team projects where each workload sits in its own RG.

- **Limitations:**

  - Everything must go into the same RG (though a nested/linked template _can_ target other RGs).

---

## 2️⃣ Subscription Scope

👉 **Above resource groups – affects subscription-wide settings**

- **Where the resources go:** Into a subscription, but can create RGs **and** resources across multiple RGs.
- **Deployment command:**

  - CLI → `az deployment sub create`
  - PS → `New-AzSubscriptionDeployment`

- **Typical resources deployed here:**

  - Resource groups themselves (`Microsoft.Resources/resourceGroups`).
  - Policy assignments (subscription-level).
  - Role assignments (RBAC at subscription).
  - Networking resources that span RGs.

- **When to use:**

  - You want to _create resource groups dynamically_ in your template.
  - Enforcing policies or RBAC across the whole subscription.
  - Governance scenarios.

- **Limitations:**

  - Cannot deploy “normal” resources (VMs, storage accounts, etc.) unless you also specify their RG in the template.

---

## 3️⃣ Management Group Scope

👉 **For _multiple subscriptions_ under one governance umbrella**

- **Where the resources go:** To a management group (logical container for subscriptions).
- **Deployment command:**

  - CLI → `az deployment mg create`
  - PS → `New-AzManagementGroupDeployment`

- **Typical resources deployed here:**

  - Azure Policy definitions and assignments.
  - RBAC role assignments at management group.
  - Blueprints (governance across subscriptions).

- **When to use:**

  - Enterprise environments managing 10s–100s of subscriptions.
  - Central IT enforcing _guardrails_ across all child subscriptions.
  - Setting up policies, naming conventions, cost controls org-wide.

- **Limitations:**

  - Cannot create resource groups or resources directly (only governance-level items).

---

## 4️⃣ Tenant Scope

👉 **Top level = Entire Azure Active Directory (now Microsoft Entra ID) tenant**

- **Where the resources go:** Across the _entire tenant_.
- **Deployment command:**

  - CLI → `az deployment tenant create`
  - PS → `New-AzTenantDeployment`

- **Typical resources deployed here:**

  - Management groups.
  - Policy definitions at tenant.
  - Role definitions at tenant.
  - Subscription creation (via APIs).

- **When to use:**

  - Enterprise-wide standardization before subscriptions exist.
  - Defining _root policies_ inherited by all management groups/subscriptions.

- **Limitations:**

  - Very high-privilege – requires Tenant Root Group permissions.
  - Not for “everyday workloads.”

---

## 🧭 When to Use Which Scope

| Scope                | Best For                                                     | Examples                                                            |
| -------------------- | ------------------------------------------------------------ | ------------------------------------------------------------------- |
| **Resource Group**   | Workload deployment (most day-to-day deployments).           | VMs, storage accounts, web apps, VNets inside a single project RG.  |
| **Subscription**     | Deploying **multiple RGs** and subscription-level resources. | Creating RGs, assigning policies at subscription, RBAC assignments. |
| **Management Group** | Governing **multiple subscriptions** consistently.           | Policies, role assignments, blueprints for an enterprise.           |
| **Tenant**           | Organization-wide governance **before/above subscriptions**. | Creating management groups, global policy/role definitions.         |

---

## 🚦 Authentication vs Authorization at Scopes

- **Authentication** → proving _who you are_ (Azure AD / Entra ID identity).
- **Authorization** → proving _what you can do_ at that scope.

  - Example: You might authenticate fine, but if you don’t have `Owner` or `Contributor` at **subscription scope**, you can’t deploy there.

> 🔑 Rule of thumb: **higher scopes need higher permissions**.

- RG scope → need Contributor at RG.
- Subscription scope → need Contributor at subscription.
- MG/Tenant scope → need elevated **Owner / User Access Admin** at that level.

---

## ✅ Quick takeaway:

- **99% of workloads** → deploy to **resource group**.
- **Org-wide rules/policies** → deploy to **subscription, management group, or tenant**, depending on how broad you want to go.
