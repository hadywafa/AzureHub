# ğŸŒ **Azure Network Watcher**

## ğŸ“– **Introduction**

Azure Network Watcher is a **regional service** that provides:

- **Monitoring** ğŸ”­ (Is my network healthy?)
  - Watch health & performance in real-time.
- **Diagnostics** ğŸ©º (Why isnâ€™t this working?)
  - Debug routing, NSGs, and connectivity issues fast.
- **Logging** ğŸ“œ (What happened yesterday at 3am?)
  - Track flows & traffic for audits, compliance, and â€œaha!â€ moments.

---

<div align="center">
  <img src="images/az-nw.png" alt="az-nw" style="width: 100%; border-radius: 10px; border: 2px solid white;">
</div>

---

---

## ğŸ”­ **1. Monitor Features**

<div align="center">
  <img src="images/az-nw-monitor-features.png" alt="Monitor Features" style="width: 100%; border-radius: 10px; border: 2px solid white;">
</div>

---

### ğŸ—ºï¸ **1.1 Topology**

- **What it does:** Builds a visual map of your VNet (subnets, NICs, VMs, NSGs).
- **Why itâ€™s useful:** One glance = instant understanding of whoâ€™s plugged into what.
- **Example:** Like drawing your network on a whiteboard, but it updates itself.

ğŸ’¡ _Pro Tip:_ If a VM is â€œlonelyâ€ (not connected), Topology shows you right away.

---

### ğŸ”„ **1.2 Connection Monitor**

- **What it does:** Continuously tests **end-to-end connectivity** between two endpoints (VM â†’ DB, VM â†’ Internet).
- **Why itâ€™s useful:** Detects latency, packet drops, and intermittent failures.
- **Example:** Like having a ping & traceroute running 24/7 so you donâ€™t have to.

ğŸ’¡ _Pro Tip:_ Integrates with **Azure Monitor Alerts** â†’ get notified if latency spikes.

---

## ğŸ©º **2. Diagnostic Features**

<div align="center">
  <img src="images/az-nw-diagnostic-features-1.png" alt="Diagnostic Features 1" style="width: 100%; border-radius: 10px; border: 2px solid white;">
</div>

<div align="center">
  <img src="images/az-nw-diagnostic-features-2.png" alt="Diagnostic Features 2" style="width: 100%; border-radius: 10px; border: 2px solid white;">
</div>

---

### ğŸš¦ **2.1 IP Flow Verify (NSG)**

- **What it does:** Tests if specific traffic (VM â†’ Destination IP\:Port) is **Allowed/Denied** by NSGs.
- **Why itâ€™s useful:** No more guessing which NSG rule won.
- **Example:** VM canâ€™t talk to SQL DB â†’ check if NSG is silently blocking port 1433.

---

### ğŸ” **2.2 Effective Security Rules**

- **What it does:** Shows the **real security rules** applied to a NIC (after combining multiple NSGs).
- **Why itâ€™s useful:** Sometimes your â€œAllow HTTPâ€ is shadowed by a sneaky â€œDeny All.â€
- **Example:** See why inbound RDP isnâ€™t working when you _swear_ you added the rule.

---

### ğŸ›£ï¸ **2.3 Next Hop**

- **What it does:** Shows where traffic from a VM will go next (Internet, NVA, VPN, blackhole).
- **Why itâ€™s useful:** Debug wrong UDRs (User Defined Routes).
- **Example:** Expecting traffic to internet but itâ€™s going to your firewall â†’ Next Hop shows it.

---

### ğŸ“¦ **2.4 Packet Capture**

- **What it does:** Captures live packets on a VM NIC (saved as `.cap` file for Wireshark).
- **Why itâ€™s useful:** Deep analysis when â€œpings donâ€™t tell the full story.â€
- **Example:** Debug TLS handshake failures between your app and API.

---

### ğŸ” **2.5 Connection Troubleshooting**

- **What it does:** Actively tests connectivity from VM â†’ Destination.
- **Why itâ€™s useful:** Gives real reasons (NSG deny, DNS fail, route blackhole).
- **Example:** Why canâ€™t my VM browse the internet? â†’ Run this test, get instant cause.

---

### ğŸ”’ **2.6 VPN Troubleshooting**

- **What it does:** Diagnoses VPN Gateway health & tunnels.
- **Why itâ€™s useful:** Fixes â€œVPN is downâ€ before the CIO calls you at 2am.
- **Example:** See why your site-to-site VPN wonâ€™t connect (shared key mismatch, IP issue, etc).

---

## ğŸ“œ **3. Logging Features**

<div align="center">
  <img src="images/az-nw-logging-features.png" alt="Azure Network Watcher Logging Features" style="width: 100%; border-radius: 10px; border: 2px solid white;">
</div>

---

### ğŸ“Š **3.1 NSG Flow Logs**

- **What it does:** Records **all allowed/denied traffic** at NSGs.
- **Why itâ€™s useful:** Perfect for forensics & compliance.
- **Example:** Find out if a suspicious IP has been hammering your VM at night.

ğŸ’¡ _Pro Tip:_ Always pipe flow logs into **Log Analytics** â†’ query with KQL later.

---

### ğŸ“ˆ **3.2 Traffic Analytics**

- **What it does:** Processes NSG flow logs â†’ gives insights on bandwidth, patterns, anomalies.
- **Why itâ€™s useful:** Detects bandwidth hogs & strange spikes.
- **Example:** Spot that one VM hogging 80% of outbound internet traffic ğŸ“¡.

---

## ğŸªœ **Implementation Overview**

Think of it like setting up a **home surveillance system** ğŸ :

1. **Enable Network Watcher** in your region (like installing cameras).
2. **Configure diagnostic tools** (like pointing cameras at doors).
3. **Connect data sources** (link VMs, VNets).
4. **Analyze & visualize** (use Topology & Analytics dashboards).
5. **Set alerts** (motion sensors ğŸš¨).
6. **Respond** (send network team when something looks off).

---

## ğŸ **Summary**

- **Monitor Features** = keep an eye on health (Topology, Connection Monitor).
- **Diagnostic Features** = deep-dive troubleshooting (IP Flow, Next Hop, Packet Capture).
- **Logging Features** = record and analyze everything (Flow Logs, Traffic Analytics).
