# ğŸ’¾ Azure VM Storage

Azure VM Storage is the **backbone of your virtual machineâ€™s data** â€” where your OS lives, your app data resides, and your temp files do their job. Itâ€™s similar to **Amazon EC2 + EBS**, but Azure adds some unique flavors to disk types, scaling, and performance tiers.

Letâ€™s break it all down in your favorite way:

> ğŸ’¡ Disks are stored behind the scenes in **azure blob Storage** AS **Page blobs**.

---

## ğŸ§± Azure VM Disk Types

Every Azure VM is backed by **Azure Managed Disks**, which come in different flavors depending on purpose and performance.

<div align="center">
  <img src="images/vm-disk-types.png" alt="Disk Types for Azure Virtual Machines" style="width: 90%; border-radius: 10px; border: 2px solid white;">
</div>

---

### 1ï¸âƒ£ OS Disk

| Property           | Description                                               |
| ------------------ | --------------------------------------------------------- |
| ğŸ“¦ Purpose         | Holds the **Operating System** (Windows/Linux)            |
| ğŸ“Œ Type            | Always a **Managed Disk**                                 |
| ğŸ’¾ Mount Path      | Usually `C:\` (Windows) or `/dev/sda1` (Linux)            |
| ğŸ”„ Snapshot/Backup | Snapshots are supported, integrated with **Azure Backup** |
| ğŸ“ˆ Resize          | Yes, requires **deallocation** (stop VM first)            |
| â• Attach/Detach   | OS Disk is **non-removable** (unlike data disks)          |

> ğŸ§  **AWS Equivalent**: This is like your EC2 instance's root EBS volume.

---

### 2ï¸âƒ£ Data Disks

| Property      | Description                                                         |
| ------------- | ------------------------------------------------------------------- |
| ğŸ“¦ Purpose    | Store app data, logs, files, DBs, etc.                              |
| ğŸ”— Attachment | Attach/detach **dynamically** (live attach supported)               |
| ğŸ”„ Resize     | Supported **without reboot** (depending on VM SKU)                  |
| ğŸ’¾ Mount Path | Windows: `F:\`, `G:\`, etc. <br>Linux: `/dev/sdc`, `/dev/sdd`, etc. |
| ğŸ“ˆ Scaling    | Up to **32 disks per VM** (depends on VM size)                      |

> ğŸ§  **AWS Equivalent**: Just like **EBS volumes** attached to EC2 â€” persistent, resizable block storage.

---

### 3ï¸âƒ£ Temporary Disk (Local Ephemeral)

| Property        | Description                                                                   |
| --------------- | ----------------------------------------------------------------------------- |
| ğŸ“¦ Purpose      | **Scratch disk** for temporary operations: pagefile, swap, caching, temp data |
| ğŸ” Volatile     | **Data is lost** on stop/deallocate or host reboot                            |
| ğŸ’¨ High IOPS    | Great for **fast, non-critical** read/write operations                        |
| ğŸ“ Path         | `D:\` (Windows) or `/dev/sdb1` (Linux) â€“ **auto-mounted**                     |
| ğŸ“‰ Availability | Not available on all VMs (e.g., ephemeral OS VMs donâ€™t include it)            |

> ğŸ§  **AWS Equivalent**: Like **instance store volumes**, but **not user-configurable** in Azure.

---

## ğŸŒ€ Azure VM Disk Performance Tiers

You can choose your disk **performance level** based on cost, IOPS, and throughput needs â€” just like in AWS (gp2, io1, sc1).

### ğŸ”¹ Standard HDD

| Feature     | Value                     |
| ----------- | ------------------------- |
| ğŸ’° Cost     | Cheapest                  |
| âš¡ IOPS     | Lowest                    |
| â±ï¸ Latency  | Highest                   |
| ğŸ§© Use Case | Dev/Test, Backup, Archive |

---

### ğŸ”¸ Standard SSD

| Feature     | Value                       |
| ----------- | --------------------------- |
| ğŸ’° Cost     | Moderate                    |
| âš¡ IOPS     | Better than HDD, consistent |
| â±ï¸ Latency  | Lower than HDD              |
| ğŸ§© Use Case | Web servers, light DBs, VDI |

---

### ğŸ”¶ Premium SSD

| Feature     | Value                                   |
| ----------- | --------------------------------------- |
| ğŸ’° Cost     | High                                    |
| âš¡ IOPS     | Up to 20,000+ per disk                  |
| â±ï¸ Latency  | Very low (<1 ms read latency typical)   |
| ğŸ§© Use Case | SQL Server, SAP HANA, high-IO workloads |

---

### ğŸ’¡ Newer Disk Types (Bonus)

| Tier               | Use Case                                         |
| ------------------ | ------------------------------------------------ |
| **Premium SSD v2** | Ultra-fast block storage, dynamic perf config    |
| **Ultra Disk**     | DBs with extreme IOPS/latency needs (up to 160K) |

> ğŸ§  **AWS Equivalents**:
>
> - Standard HDD â†’ `sc1`
> - Standard SSD â†’ `gp2`
> - Premium SSD â†’ `io1`/`gp3`
> - Ultra Disk â†’ No direct AWS equivalent

---

## ğŸ—‚ï¸ Azure Disk Comparison Summary

| Feature        | Standard HDD  | Standard SSD | Premium SSD | Ultra Disk   |
| -------------- | ------------- | ------------ | ----------- | ------------ |
| ğŸ’° Cost        | Lowest        | Lowâ€“Mid      | High        | Very High    |
| âš¡ IOPS        | Low           | Medium       | High        | Very High    |
| ğŸ“¶ Throughput  | Low           | Medium       | High        | Very High    |
| â±ï¸ Latency     | High          | Medium       | Low         | Ultra Low    |
| ğŸ”„ Resize Live | âŒ No         | âœ… Yes       | âœ… Yes      | âœ… Yes       |
| ğŸ§© Use Cases   | Archive, Test | Web, Dev     | DBs, SAP    | Critical DBs |

---

## ğŸ”— Storage Architecture Behind the Scenes

Each disk is a **separate Azure Resource**:

```mermaid
graph TD
    subgraph Azure VM
        VM[Virtual Machine]
        OS[OS Disk]
        DD1[Data Disk 1]
        DD2[Data Disk 2]
        TEMP[Temp Disk]
    end

    OS --> AzureStorage[(Azure Managed Disks)]
    DD1 --> AzureStorage
    DD2 --> AzureStorage
    TEMP --> HypervisorLocalDisk[(Local Storage)]
```

> ğŸ“Œ Managed Disks are encrypted by default, replicated in Azure Storage, and support backup & snapshots.

---

## ğŸ›¡ï¸ Backup and Recovery Options

| Feature                       | Support                                      |
| ----------------------------- | -------------------------------------------- |
| **Azure Backup**              | Yes â€“ with full VM recovery support          |
| **Snapshot**                  | Yes â€“ point-in-time for OS or data disks     |
| **Azure Site Recovery (ASR)** | Yes â€“ disaster recovery across regions       |
| **Disk Encryption**           | Yes â€“ Azure-managed or customer-managed keys |

---

## ğŸ§  Best Practices for Azure VM Storage

| Practice                            | Benefit                                 |
| ----------------------------------- | --------------------------------------- |
| Use **Premium SSD** for prod DBs    | Ensures performance and reliability     |
| Detach unused disks                 | Avoids unnecessary billing              |
| Use snapshots before resize         | Adds a fallback checkpoint              |
| Enable Azure Backup for OS & data   | Protects against deletion or corruption |
| Use separate disks for logs/db/data | Better performance & fault isolation    |

---

## ğŸ§¾ Summary â€“ Azure VM Storage Essentials

| Component     | Purpose                            | AWS Equivalent  |
| ------------- | ---------------------------------- | --------------- |
| OS Disk       | Boot and OS storage                | EBS root volume |
| Data Disk(s)  | Persistent block storage for apps  | EBS volumes     |
| Temp Disk     | Ephemeral local storage            | Instance store  |
| Managed Disks | Azure-managed storage abstraction  | EBS-backed AMIs |
| Ultra/Premium | High-IO, high-throughput workloads | io1 / io2       |
