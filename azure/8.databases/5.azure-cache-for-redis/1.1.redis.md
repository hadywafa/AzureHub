# âš¡ **Redis**

ğŸ“– **Redis (REmote DIctionary Server)** is an **in-memory data store** used as:

- **Cache** (super-fast, keep hot data in RAM)
- **Database** (key-value, with optional persistence)
- **Message Broker** (Pub/Sub, Streams, Queues)

---

<div align="center" style="background-color: #ffffffff ;border-radius: 10px;border: 2px solid white;margin:0 30px;">
  <img src="image/1.1.redis/1759014560421.png" alt="Capture Configuration" style="border-radius: 10px; border: 2px solid white; width: 80%; background-color: #ffffffff">
</div>

---

## ğŸ”‘ **Common Redis Data Types & Commands**

### ğŸ”¹ Strings

- Most common type â€” simple key/value

  ```bash
  SET name "azure"
  GET name
  INCR counter
  EXPIRE name 60   # TTL 60 sec
  ```

### ğŸ”¹ Hashes

- Store object-like structures (like JSON but lighter)

  ```bash
  HSET user:1 name "Alice" age 30
  HGET user:1 name
  HGETALL user:1
  ```

### ğŸ”¹ Lists

- Ordered collection, push/pop from both ends

  ```bash
  LPUSH queue task1
  RPUSH queue task2
  LPOP queue
  LRANGE queue 0 -1
  ```

### ğŸ”¹ Sets

- Unique values, like a `HashSet`

  ```bash
  SADD tags azure redis cache
  SMEMBERS tags
  SISMEMBER tags redis
  ```

### ğŸ”¹ Sorted Sets

- Like Sets, but with a score â†’ good for leaderboards

  ```bash
  ZADD leaderboard 100 "Alice"
  ZADD leaderboard 200 "Bob"
  ZRANGE leaderboard 0 -1 WITHSCORES
  ```

### ğŸ”¹ Pub/Sub

- Simple message broadcasting

  ```bash
  SUBSCRIBE news
  PUBLISH news "Hello Redis!"
  ```

### ğŸ”¹ Streams

- Log-based data, Kafka-lite style

  ```bash
  XADD mystream * user "Alice" msg "Hello"
  XRANGE mystream - +
  XREAD COUNT 1 STREAMS mystream $
  ```

---

### ğŸ”¹ Special Data Types

- **Bitmap** â†’ track bits efficiently (`SETBIT`, `GETBIT`)
- **HyperLogLog** â†’ approx unique count (`PFADD`, `PFCOUNT`)
- **Geospatial** â†’ store/query lat-long (`GEOADD`, `GEORADIUS`)
- **Streams** â†’ append-only log for events (`XADD`, `XREAD`)

---

## âš™ï¸ **How Redis Works**

- **In-memory engine**: All keys/values live in RAM â†’ microsecond access.
- **Persistence** (optional):

  - **RDB (snapshot)**: saves dump.rdb at intervals
  - **AOF (append-only file)**: logs every write â†’ replay on restart
  - Can combine RDB + AOF

- **Single-threaded event loop** (non-blocking I/O) â†’ predictable latency
- **Network model**: Uses **RESP protocol** over TCP (binary-safe).

---

## ğŸ“ˆ **Scaling Redis**

Redis can scale in **two ways**:

### â¬†ï¸ Vertical Scaling (VL)

- Add more CPU, RAM to single node.
- âœ… Simple
- âŒ Expensive, limited by machine size

---

### â¡ï¸ Horizontal Scaling (HZ â€“ Redis Cluster)

- Data **sharded** into 16,384 **hash slots**.
- Slots distributed across multiple **masters (M1, M2, M3)**.
- Each master has replicas (S1, S2, S3).
- **Clients â†’ ask cluster â†’ cluster routes request to correct slot.**
- Uses **Gossip protocol** to share node state.

<div align="center" style="background-color: #ffffffff ;border-radius: 10px;border: 2px solid white;margin:0 30px;">

```mermaid
graph LR
  C[Client] --> R1[Redis Node 1]
  C --> R2[Redis Node 2]
  C --> R3[Redis Node 3]
  R1:::slot -->|Keys 0-5500| C
  R2:::slot -->|Keys 5501-11000| C
  R3:::slot -->|Keys 11001-16383| C
classDef slot fill:#f9f,stroke:#333,color:black,stroke-width:1px;
```

</div>

---

> ğŸ“Œ Example:  
> ğŸ”¹ `SET user:100` â†’ Redis hashes key â†’ slot â†’ sends to correct master.  
> ğŸ”¹ If that master fails â†’ replica promoted â†’ HA.

---

## â¤ï¸ **High Availability (HA)**

### ğŸŸ¢ Replication

- Master â†’ one or more replicas.
- Replicas can serve read queries.

### ğŸŸ¢ Redis Sentinel

- Separate monitoring nodes.
- Detect failure of master.
- Elect a replica â†’ promote to master.
- Clients automatically redirected.

### ğŸŸ¢ Redis Cluster

- Combines **sharding + replication + HA**.
- Built-in failover, no single point of failure.

---

## ğŸš¦ **Typical Use Cases**

- **Cache-aside** pattern â†’ reduce DB load
- **Session store** â†’ fast user sessions
- **Leaderboard** â†’ sorted sets
- **Queue** â†’ lists or streams
- **Rate limiting** â†’ counters + TTL
- **Pub/Sub** â†’ event notifications

---

## ğŸ“ **Quick Memory Hooks**

- **String** = basic value
- **Hash** = object (user profile)
- **List** = queue/stack
- **Set** = unique tags
- **Sorted Set** = leaderboard
- **Pub/Sub** = chat, events
- **Streams** = Kafka-lite
