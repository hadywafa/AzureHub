# âš¡ Application Insights Performance Feature

## ğŸ“– Official definition (in human words)

The **Performance blade** in Azure Application Insights gives you a **birdâ€™s-eye view of your appâ€™s responsiveness**.
It continuously collects **telemetry about requests, dependencies, and exceptions**, then aggregates it into **performance metrics** like:

- Request duration (avg, p50, p95, p99)
- Failure rates
- Dependency call duration (SQL, HTTP, storage, etc.)
- Slowest endpoints & methods
- Live metrics (real-time)

ğŸ‘‰ In short: **it tells you what is slow, how slow, and how often**.

---

## ğŸ—ï¸ How it works under the hood

1. **SDK or Auto-instrumentation** injects telemetry collectors into your app.
2. Each incoming request is timed, tagged, and logged as a `RequestTelemetry` event.
3. Dependency calls (SQL, HTTP, Redis, Storage) are automatically tracked as `DependencyTelemetry`.
4. These events are sampled (to reduce noise) and shipped to Application Insights.
5. The **Performance blade** aggregates & visualizes this data â†’ avg response time, percentile charts, and â€œtop slowest requests.â€

---

## ğŸ§­ Flow: Performance data pipeline

```mermaid
---
config:
  theme: dark
title: "App Insights Performance Flow"
---
flowchart LR
    A[Incoming Request] --> B[AI SDK/Agent Instrumentation]
    B --> C[Telemetry Collected: req/deps/exc]
    C --> D[Sampling & Correlation IDs]
    D --> E[AI Ingestion Endpoint]
    E --> F[App Insights Store]
    F --> G[Performance Blade Dashboard]

    classDef node fill:#99ffa5,stroke:#333,stroke-width:2px,color:#222;
    class A,B,C,D,E,F,G node
```

---

## ğŸ” What you see in the Performance blade

- **Top requests**: endpoints ranked by call count & avg duration.
- **Slowest requests**: sorted by latency.
- **Dependencies**: breakdown of SQL, HTTP, storage calls.
- **Percentiles**: not just averages â€” you see p50, p95, p99 (great for SRE/SLI/SLO).
- **Failure hotspots**: which requests fail most often.
- **Operation drill-down**: click into one request to see all dependency calls.

---

## ğŸ“œ Sequence: From user request to performance dashboard

```mermaid
---
config:
  look: handDrawn
  theme: dark
title: "Performance Monitoring Sequence"
---
sequenceDiagram
    participant U as User
    participant App as Application
    participant SDK as AI SDK/Agent
    participant AI as App Insights

    U->>App: Send HTTP request
    App->>SDK: Request processed (timing started)
    SDK->>App: Wraps dependency calls (SQL/HTTP/etc.)
    App->>SDK: Finish request
    SDK->>AI: Send RequestTelemetry & DependencyTelemetry
    AI-->>DevOps: Aggregated metrics in Performance blade
    Note over AI: â€œ/api/orders avg=1.8s, p95=4.2s, 2% failedâ€
```

---

## ğŸ§ª Hands-on (5â€“10 min demo)

1. **Enable Application Insights**

   - In Azure Portal â†’ go to App Service â†’ **Application Insights â†’ Turn On**.
   - Or via code: add AI SDK (`Microsoft.ApplicationInsights.AspNetCore`).

2. **Generate load**

   - Run simple load test (e.g., curl loop, JMeter, Azure Load Testing).

3. **Explore Performance blade**

   - Go to AI resource â†’ **Investigate â†’ Performance**.
   - Look at â€œTop requestsâ€ and â€œSlowest requests.â€
   - Drill into one endpoint (e.g., `/api/orders`) â†’ see dependency breakdown.

4. **Check percentiles**

   - Notice how p95 may be way higher than avg â€” useful for SLA/SLO analysis.

---

## ğŸ§  Cheat sheet

- **Purpose**: high-level performance view (which requests, how slow, how often).
- **Data type**: aggregated telemetry (requests, dependencies, exceptions).
- **Granularity**: endpoint/operation level (not line-of-code).
- **Best for**: SRE dashboards, SLA/SLO tracking, release performance regression.
- **Not for**: finding the exact code method â€” thatâ€™s Profilerâ€™s job.
- **Killer tip**: always check **p95/p99** â€” averages hide customer pain.

---

âœ… So: **Application Insights Performance = your appâ€™s fitness tracker** ğŸƒâ€â™‚ï¸ (tells you which runs are slow and how often).
Later, if you need to know **which muscle is cramping (which line of code)** â†’ thatâ€™s where **Profiler** kicks in.
