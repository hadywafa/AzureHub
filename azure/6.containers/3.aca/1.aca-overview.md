# üê≥ Azure Container Apps (ACA) ‚Äì Explained

## üìñ What is ACA?

Azure Container Apps is a **serverless container platform** for running microservices, APIs, background jobs, or event-driven workloads **without managing Kubernetes directly**.

Think of it as:

- **ACI** = single container/group, simple workloads.
- **AKS (Kubernetes Service)** = full Kubernetes cluster, max control but complex.
- **ACA** = sweet spot in the middle üèñÔ∏è ‚Üí serverless, but with **Kubernetes features under the hood**.

---

![Azure Container Apps Deployment](images/aca-3.png)

---

## ‚ú® Key Features

- **Serverless scaling**:

  - Scale **to zero** (no requests ‚Üí no cost).
  - Auto-scale based on **HTTP requests, CPU, memory, or even events** (KEDA integration).

- **Multiple revisions (blue/green)**:

  - Deploy multiple versions of the same app ‚Üí split traffic 50/50 or 90/10.

- **Microservice friendly**:

  - Supports **Dapr (Distributed Application Runtime)** ‚Üí service-to-service calls, pub/sub, secrets, state.

- **Networking options**:

  - Public endpoint, internal only, or VNET integrated.

- **Secrets and Config**:

  - Inject secrets via Azure Key Vault or directly from Container App environment.

---

## üèóÔ∏è ACA Architecture (High-Level)

üîπ **Environment** = a secure boundary where your Container Apps live.  
üîπ Inside, you can run **multiple Container Apps** (like namespaces in Kubernetes).  
üîπ Each app can have **revisions** (versions).  
üîπ Scaling & secrets are managed for you.

---

```mermaid
flowchart LR
    User((User)) --> |HTTP/API| Env[Container App Environment]
    subgraph Env["Container App Environment"]
        Web[Web App Container]
        API[API Container]
        Worker[Worker Container]
    end
    Env --> ACR[(Azure Container Registry)]
    Env --> EventHub[(Event Hub / Service Bus)]
    Env --> KV[(Azure Key Vault)]
```

---

## ‚ö° ACA vs ACI

| Feature                | ACI üê£                        | ACA üöÄ                                  |
| ---------------------- | ----------------------------- | --------------------------------------- |
| Purpose                | Simple, single-container jobs | Long-running microservices & APIs       |
| Scaling                | Manual or fixed               | Autoscale (incl. scale-to-zero)         |
| Networking             | Public IP, basic DNS          | Ingress controller, VNET, internal-only |
| Secrets                | Env vars                      | Env vars + Key Vault integration        |
| Revisions / Blue-Green | ‚ùå                            | ‚úÖ                                      |
| Event-driven (KEDA)    | ‚ùå                            | ‚úÖ                                      |
| Dapr microservices     | ‚ùå                            | ‚úÖ                                      |

---

## üõ†Ô∏è Hands-On: Deploy a Simple ACA

### 1Ô∏è‚É£ Create Resource Group

```bash
RG=rg-aca-demo
LOC=eastus
az group create -n $RG -l $LOC
```

### 2Ô∏è‚É£ Create ACA Environment

```bash
az containerapp env create \
  -n aca-env-demo \
  -g $RG \
  --location $LOC
```

### 3Ô∏è‚É£ Deploy Container App (Public Hello World)

```bash
az containerapp create \
  -n aca-hello \
  -g $RG \
  --environment aca-env-demo \
  --image mcr.microsoft.com/azuredocs/containerapps-helloworld:latest \
  --target-port 80 \
  --ingress 'external' \
  --min-replicas 0 \
  --max-replicas 5
```

### 4Ô∏è‚É£ Get URL

```bash
az containerapp show -n aca-hello -g $RG --query properties.configuration.ingress.fqdn -o tsv
```

Open in browser üéâ.

---

## üì¶ CI/CD with ACA

- Push image to **ACR** or **DockerHub**.
- Deploy with `az containerapp update --image <your-registry>/<image>:tag`.
- Or integrate with **GitHub Actions** / **Azure DevOps pipelines**.

---

## üí° When to use ACA?

- ‚úÖ Build **APIs / web apps** without Kubernetes overhead
- ‚úÖ Run **event-driven workers** that scale on Service Bus, Event Hub, or Queue messages
- ‚úÖ Deploy **microservices** with Dapr service-to-service comms
- ‚úÖ Use **blue/green rollouts** safely

- ‚ùå If you need **full Kubernetes control** ‚Üí use AKS.
- ‚ùå If it‚Äôs just a quick one-off container ‚Üí ACI is simpler.

---

## üí∞ Pricing and Plans

ACA offers a serverless pricing model, charging based on the resources consumed during execution.

| **Resource**           | **Unit**                 | **Approximate Cost**            |
| ---------------------- | ------------------------ | ------------------------------- |
| **vCPU**               | Per vCPU-second          | **\$0.000013** per vCPU-second  |
| **Memory**             | Per GB-second            | **\$0.0000018** per GB-second   |
| **Environment**        | Per instance per hour    | **\$0.20** per environment-hour |
| **Ingress and Egress** | Per GB of data processed | **\$0.087** per GB              |

‚úçüèª **Example:**

Running a container app with 1 vCPU and 2 GB memory for 1,000 seconds:

- **CPU Cost:** 1 vCPU √ó 1,000 seconds √ó $0.000013 = **$0.013\*\*
- **Memory Cost:** 2 GB √ó 1,000 seconds √ó $0.0000018 = **$0.0036\*\*
- **Total Cost:** Approximately **\$0.0166** (excluding environment and networking costs)

üìå **Factors Affecting Cost:**

- **Resource Consumption:** Number of vCPUs and amount of memory used during execution.
- **Execution Time:** Duration of container execution.
- **Data Transfer:** Amount of data processed and transferred.

üìí **Note:** Prices are approximate and can vary based on the Azure region. For precise estimates, visit the [Azure Pricing Calculator](images/https://azure.microsoft.com/pricing/calculator/).
