# Short answer (TL;DR)

> **If you create 3 Kubernetes Services of type `LoadBalancer`, AKS will NOT create 3 Azure Load Balancers by default.**
> It will:
>
> - Reuse the **same Azure Standard Load Balancer**
> - Create **3 frontend IP configurations**
> - Create **3 load-balancing rules**
> - All rules will point to the **same `kubernetes` backend pool**

Nothing happens **until you create those Services**.

---

# Now letâ€™s explain it properly (slow & visual)

---

## 1ï¸âƒ£ Your current state (important baseline)

Right now:

- AKS cluster created
- Azure Load Balancer exists
- Backend pools exist
- âœ… **ONLY outbound rules**
- âŒ **NO inbound rules**
- âŒ **NO frontend IPs for apps**

So inbound traffic = **nothing exposed**

---

## 2ï¸âƒ£ You create the FIRST Service (LoadBalancer)

```yaml
apiVersion: v1
kind: Service
metadata:
  name: svc-1
spec:
  type: LoadBalancer
  ports:
    - port: 80
      targetPort: 8080
```

### What AKS does in Azure

AKS (via Cloud Controller Manager) creates:

| Azure LB Component  | Result                        |
| ------------------- | ----------------------------- |
| Frontend IP         | âœ… Public IP #1               |
| Load balancing rule | âœ… Rule #1 (80 â†’ nodePort)    |
| Backend pool        | âœ… Uses existing `kubernetes` |
| Health probe        | âœ… Created                    |

---

## 3ï¸âƒ£ You create the SECOND Service

```yaml
metadata:
  name: svc-2
```

### Azure behavior

| Component     | Result            |
| ------------- | ----------------- |
| Load Balancer | âŒ Not new        |
| Frontend IP   | âœ… Public IP #2   |
| LB rule       | âœ… Rule #2        |
| Backend pool  | Same `kubernetes` |

---

## 4ï¸âƒ£ You create the THIRD Service

Same thing again ðŸ‘‡

| Component     | Result             |
| ------------- | ------------------ |
| Load Balancer | Still the same one |
| Frontend IP   | âœ… Public IP #3    |
| LB rule       | âœ… Rule #3         |
| Backend pool  | Same `kubernetes`  |

---

## 5ï¸âƒ£ Final Azure Load Balancer state (important)

You end up with:

```
Azure Load Balancer
â”œâ”€â”€ Frontend IPs
â”‚   â”œâ”€â”€ PublicIP-1 (svc-1)
â”‚   â”œâ”€â”€ PublicIP-2 (svc-2)
â”‚   â””â”€â”€ PublicIP-3 (svc-3)
â”‚
â”œâ”€â”€ Load Balancing Rules
â”‚   â”œâ”€â”€ Rule-1 â†’ svc-1
â”‚   â”œâ”€â”€ Rule-2 â†’ svc-2
â”‚   â””â”€â”€ Rule-3 â†’ svc-3
â”‚
â””â”€â”€ Backend Pool
    â””â”€â”€ kubernetes
        â”œâ”€â”€ Node-1
        â””â”€â”€ Node-2
```

---

## 6ï¸âƒ£ Important: Same backend pool, different Services â€” why?

Because:

- Azure LB only knows **nodes**
- Kubernetes decides:

  - Which pod gets traffic
  - Based on NodePort + kube-proxy

Azure LB job stops at:

> â€œSend traffic to a healthy nodeâ€

---

## 7ï¸âƒ£ What happens at runtime (traffic flow)

```mermaid
sequenceDiagram
    participant Client
    participant AzureLB
    participant Node
    participant KubeProxy
    participant Pod

    Client->>AzureLB: Request to PublicIP-2
    AzureLB->>Node: Forward to NodePort
    Node->>KubeProxy: Match service
    KubeProxy->>Pod: Route to correct pod
```

ðŸ”‘ **Azure does not know which service/pod**
Kubernetes handles that internally.

---

## 8ï¸âƒ£ Do NAT rules get created?

âŒ No
Still **no inbound NAT rules**

Why?

- Kubernetes requires **fan-out**
- NAT rules are **1:1**
- LB rules support **1:many**

---

## 9ï¸âƒ£ Can AKS ever create multiple Load Balancers?

### Yes â€” but only if you ASK it to

Example:

```yaml
annotations:
  service.beta.kubernetes.io/azure-load-balancer-resource-group: custom-rg
```

Or:

- Internal vs External LB
- Multiple Standard LBs
- Advanced isolation scenarios

By default:

> **ONE Load Balancer per AKS cluster**

---

## ðŸ”Ÿ Cost & limits (important!)

| Item                    | Limit                   |
| ----------------------- | ----------------------- |
| Frontend IPs per LB     | 600                     |
| LB rules                | Hundreds                |
| Recommended LB services | Few (Ingress preferred) |

ðŸ‘‰ Best practice:

> Use **Ingress Controller** instead of many LoadBalancer services

---

## 1ï¸âƒ£1ï¸âƒ£ Best-practice architecture (production)

Instead of:
âŒ 10 Services â†’ 10 Public IPs

Use:
âœ… 1 Ingress Controller
âœ… 1 Public IP
âœ… Path / host routing

---

## ðŸ§  Final mental model (memorize this)

> **Each Service of type LoadBalancer adds a frontend IP and rule to the same Azure Load Balancer â€” it does not create a new load balancer.**

---

## ðŸ§ª Interview-ready one-liner

> _Creating multiple Kubernetes LoadBalancer services results in multiple frontend IP configurations and rules on a single Azure Standard Load Balancer, all targeting the same node backend pool._

---

If you want next, I can:

- Show **exact Azure portal changes after each Service**
- Explain **internal vs external LoadBalancer services**
- Explain **Ingress vs LoadBalancer vs Application Gateway**

Just tell me ðŸ‘Œ
