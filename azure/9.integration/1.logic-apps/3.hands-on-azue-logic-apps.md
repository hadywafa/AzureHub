# âœğŸ» Building a Logic App in the Azure Portal (Enhanced Walkthrough)

In this walkthrough, weâ€™ll create a **business workflow** in Azure Logic Apps.
ğŸ¯ **Scenario**: Linda, a new team member, receives invoice emails. Each invoice must:

1. Trigger a Teams notification (so Linda never misses one).
2. Capture Lindaâ€™s response (completed/pending).
3. Send a confirmation email back to the team.

This shows how Logic Apps can **integrate Outlook + Teams + business logic** with _zero custom backend code_.

---

## ğŸ› ï¸ Step 1. Create the Logic App

1. Log in to the **Azure Portal**.
2. Search for **Logic Apps**.
3. Click **Add** â†’ choose or create a resource group.
4. Select **Consumption model** (serverless, pay-per-execution).
5. Give it a name â†’ e.g., `LindaTeamsWorkflow`.
6. Pick a region (e.g., _East US_) and click **Create**.
7. After deployment â†’ click **Go to resource** â†’ open **Logic Apps Designer** to start adding triggers and actions.

<div align="left">
  <img src="image/1759434236686.png" alt="Azure Logic Apps" style="border-radius: 10px; border: 2px solid white; width: 60%;margin: 0 30px">
</div>

<div align="left">
  <img src="image/1759434317415.png" alt="Azure Logic Apps" style="border-radius: 10px; border: 2px solid white; width: 60%;margin: 0 30px">
</div>

---

## ğŸ“© Step 2. Configure the Email Trigger

The workflow starts when Linda gets an invoice email.
Weâ€™ll use **Outlook 365 connector** with **â€œWhen a new email arrivesâ€**.

1. Add trigger â†’ Outlook 365 â†’ â€œWhen a new email arrivesâ€.
2. Sign in with Lindaâ€™s account.
3. Configure filters:

   - Folder: `Inbox`
   - Importance: `Any`
   - Subject filter: `"INV"` (only triggers on invoice emails).

<div align="left">
  <img src="image/1759434358885.png" alt="Azure Logic Apps" style="border-radius: 10px; border: 2px solid white; width: 60%;margin: 0 30px">
</div>

<div align="left">
  <img src="image/1759434395839.png" alt="Azure Logic Apps" style="border-radius: 10px; border: 2px solid white; width: 60%;margin: 0 30px">
</div>

---

> âœ… **Best practice**: Always filter early at the trigger level to reduce unnecessary executions (saves cost + improves performance).

---

## ğŸ’¬ Step 3. Add Microsoft Teams Action

Next, we notify Linda in **Teams**.

1. Add an **Action** â†’ Microsoft Teams connector.
2. Authenticate with Lindaâ€™s account.
3. Use â€œPost a messageâ€ (or â€œPost adaptive card and wait for a responseâ€ for richer UI).
4. Insert **dynamic content** (e.g., invoice number from the email subject).

<div align="left">
  <img src="image/1759434442950.png" alt="Azure Logic Apps" style="border-radius: 10px; border: 2px solid white; width: 60%;margin: 0 30px">
</div>

---

> ğŸ’¡ **Tip**: Dynamic content ensures the Teams message always carries invoice details **from the original email trigger**.

---

## ğŸ”€ Step 4. Add Conditional Logic (User Response)

We want to branch workflow based on Lindaâ€™s response.

1. Insert **Condition Control**.
2. Evaluate `Selected Option` from Teams.

   - âœ… If `"completed"` â†’ Send confirmation email.
   - âŒ If `"pending"` â†’ End workflow with log.

---

### âœ… Case: Completed

- Action: Outlook 365 â†’ â€œSend an emailâ€.
- Recipients: Rithin (with Linda ccâ€™d).
- Body: Include **confirmation number** from Teams response.

<div align="left">
  <img src="image/1759434632783.png" alt="Azure Logic Apps" style="border-radius: 10px; border: 2px solid white; width: 60%;margin: 0 30px">
</div>

---

### âŒ Case: Pending

- Action: Terminate workflow.
- Optionally log â†’ â€œInvoice not completedâ€ with status code **500**.

<div align="left">
  <img src="image/1759434709465.png" alt="Azure Logic Apps" style="border-radius: 10px; border: 2px solid white; width: 60%;margin: 0 30px">
</div>

---

## ğŸ§ª Step 5. Test the Logic App

1. Send an email â†’ subject contains `"INV12345"`.
2. Logic App triggers â†’ Teams message appears with invoice details.
3. Linda replies `"completed: 7890"`.
4. Logic App â†’ sends confirmation email with **invoice + confirmation number**.

### Sample JSON (trigger output)

```json
{
  "subscribe": {
    "method": "post",
    "queries": {
      "fetchOnlyWithAttachment": "False",
      "folderPath": "Inbox",
      "importance": "Any"
    }
  }
}
```

### Sample Payload (email trigger)

```json
{
  "BodyPreview": "please process.",
  "importance": "normal",
  "conversationId": "AAQAGQZzJk4OTQkLWFmZDQ2NGIyNC04NTRlTM2Yjk4",
  "isRead": false,
  "isHtml": true,
  "from": "rithin@azuretales.com",
  "toRecipients": ["jiones@azuretales.com"]
}
```

---

## ğŸ“¸ User Experience Flow

- Lindaâ€™s Teams message:

<div align="left">
  <img src="image/1759434807374.png" alt="Azure Logic Apps" style="border-radius: 10px; border: 2px solid white; width: 60%;margin: 0 30px">
</div>

- Confirmation email to Rithin:

<div align="left">
  <img src="image/1759434830831.png" alt="Azure Logic Apps" style="border-radius: 10px; border: 2px solid white; width: 60%;margin: 0 30px">
</div>

- Logic App run status (portal monitoring):

<div align="left">
  <img src="image/1759434838247.png" alt="Azure Logic Apps" style="border-radius: 10px; border: 2px solid white; width: 60%;margin: 0 30px">
</div>

---

## ğŸ¯ Key Takeaways

- **Triggers**: Define when a workflow starts (email in this case).
- **Actions**: Steps (Teams message, email).
- **Control logic**: Conditions make workflows smart.
- **Dynamic content**: Glue between steps.
- **Monitoring**: Every run shows inputs/outputs â†’ easy troubleshooting.

---

## ğŸ§  Exam/Interview Tip

- If asked to compare:

  - **Logic Apps** â†’ enterprise workflows with connectors, B2B integration, designer-first.
  - **Power Automate** â†’ end-user workflows (citizen dev).
  - **Azure Functions** â†’ code-first automation.

---

## ğŸ Summary WorkFlow

```mermaid
sequenceDiagram
    autonumber
    participant R as Rithin (Sender)
    participant O as Outlook 365 (Inbox - Linda)
    participant L as Logic App (Consumption)
    participant T as Microsoft Teams (Linda)
    participant U as Linda (User)

    Note over R,O: Subject contains "INV" (e.g., "INV-12345")

    R->>O: Send invoice email (Subject: INV-12345)
    O-->>L: Trigger: When a new email arrives\nFilters: folder=Inbox, importance=Any, subject contains "INV"

    rect rgba(82, 37, 37, 1)
    L->>L: Extract dynamic content\n- InvoiceNo â† triggerBody()?['Subject']\n- BodyPreview, From, etc.
    end

    L->>T: Action: Post message (or Adaptive Card)\nMessage includes InvoiceNo + instructions
    T-->>U: Notify Linda in Teams

    par (Optional) Wait for response
        Note over U,T: If using "Post adaptive card and wait for a response"
        U->>T: Respond with status ("completed" / "pending")\n+ optional ConfirmationNo
        T-->>L: Return SelectedOption + ConfirmationNo
    and (Simple notify)
        Note over L: If using "Post message" only,\nuse a separate step (e.g., Teams/Forms/HTTP) to collect response
    end

    alt Response == "completed"
        L->>O: Action: Send email\nTo: Rithin (CC: Linda)\nSubject: Invoice INV-12345 processed\nBody: Includes ConfirmationNo
        O-->>R: Confirmation email delivered
        Note over L: Run Status = Succeeded
    else Response != "completed" (e.g., "pending" / timeout)
        L->>L: Terminate (Status: Failed or Canceled)\nLog: "Invoice not completed"
        Note over L: Run Status = Terminated/Failed\n(Use Scope + Run After to log details)
    end
```

- **Trigger**: Outlook 365 â†’ _When a new email arrives_

  - Filters: `Inbox`, `Importance = Any`, `Subject contains "INV"`.

- **Teams step**: prefer **â€œPost adaptive card and wait for a responseâ€** (richer UX + built-in wait).

  - Captures: `SelectedOption`, `ConfirmationNo` (from a text input).

- **Condition**: `@equals(body('Teams_Step')?['SelectedOption'], 'completed')`
- **Email (then branch)**: use dynamic content from trigger and Teams step:

  - Subject: `Invoice @{triggerBody()?['Subject']} processed`
  - Body: `Confirmation #: @{body('Teams_Step')?['ConfirmationNo']}`

- **Terminate (else branch)**: set `Status = Failed` (or `Canceled`) and log a friendly message.

  - Wrap main steps in a **Scope** and add a **Run After** path for error logging â†’ better observability.

## ğŸ“š References

- <https://notes.kodekloud.com/docs/AZ-305-Microsoft-Azure-Solutions-Architect-Expert/Design-a-compute-solution/Design-for-Azure-Logic-Apps>
