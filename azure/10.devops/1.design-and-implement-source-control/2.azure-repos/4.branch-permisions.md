# 🔒 **Azure Repos Branch Permissions**

## 📖 **What Are Branch Permissions?**

Branch Permissions = **rules that control who can do what on a Git branch** in Azure Repos.
They let you **protect sensitive branches** (like `main`, `release`) and give developers freedom on **feature branches**.

👉 Think of them as **🚪 door locks**:

- Some people can **👀 read only**
- Some can **✍️ push changes**
- Some can **💥 rebuild the whole door** (force push)
- Some can even **🔑 remove other people’s locks**

---

## 🧱 **Why Use Them?**

Without permissions, anyone could:

- Force-push history → 💣 mess up `main`.
- Push unreviewed code → 😱 break production.
- Merge without following branch policies.

With permissions:

- `main` stays clean.
- Only authorized people can bypass policies.
- Developers can still freely manage their own feature branches.

---

## 🛠️ **How to Set Branch Permissions**

### Steps (UI flow):

1. Go to **Repos → Branches**.
2. Find the branch (`main` for example).
3. Click the `...` → **Branch security**.
4. Assign **Allow**, **Deny**, or **Not set** for each permission.
5. Save ✅.

---

## 🗝️ **Types of Branch Permissions**

| Permission                              | What It Does                            | Example                             |
| --------------------------------------- | --------------------------------------- | ----------------------------------- |
| **Contribute**                          | Push commits, lock branch               | Push bug fixes to `feature/login`   |
| **Force push**                          | Rewrite history, delete branch          | Rebase & push a rewritten branch    |
| **Manage permissions**                  | Grant/revoke rights for others          | Let leads manage security on `main` |
| **Remove others’ locks**                | Unlock branch if someone else locked it | Ops unlocks branch locked by dev    |
| **Bypass policies when pushing**        | Push directly, ignoring branch policies | Emergency hotfix to `main`          |
| **Bypass policies when completing PRs** | Complete PR even if policies not met    | Merge PR without reviewers          |

⚠️ **Danger zone** = Force push + Bypass policies. Only admins should have these!

---

## 🔄 **Inheritance & Defaults**

- By default, **repository permissions apply to all branches**.
- But you can **override** them per branch.

✨ When you create a new branch, you (the creator) automatically get:

- **Contribute** ✅
- **Force push** ✅
- **Manage permissions** ✅ (if allowed at repo level)
- **Remove others’ locks** ✅

👉 This makes feature branches flexible (you don’t need admin help).

---

## 🧭 **Precedence Rules (Allow vs Deny)**

- **Deny wins over Allow.**
- Example: If group = Allow, but user = Deny → ❌ denied.
- Exception: **Project Collection Admins** can override.

---

## 📋 **Real-World Setup Examples**

### 🔹 Protecting `main` branch

- Contribute → ❌ Deny for all devs
- Force push → ❌ Deny
- Bypass policies → ❌ Deny for everyone except release managers
- Manage permissions → ✅ Only team leads

👉 Ensures `main` is untouchable unless through PRs + approvals.

### 🔹 Feature branches

- Contribute → ✅ Allow for creator
- Force push → ✅ Allow (let devs rebase/rewrite freely)
- Manage permissions → ✅ Allow for creator

👉 Developers can work flexibly without bottlenecks.

---

## 🆚 **Branch Policies vs Branch Permissions**

| Feature | Branch Policies                           | Branch Permissions                           |
| ------- | ----------------------------------------- | -------------------------------------------- |
| Purpose | Ensure **quality** of code before merging | Control **who can act** on branch            |
| Example | Require 2 reviewers, run CI build         | Deny force push, allow only admins to bypass |
| Focus   | Process & governance                      | Access & security                            |
| Scope   | Usually `main`, `release`                 | Any branch                                   |

👉 Together: **Policies = rules of the game, Permissions = who can play.** 🎮

---

## ✅ **Summary**

- **Branch Permissions = security guardrails** for your branches.
- Control **who can contribute, force push, bypass policies, or manage rights**.
- Default branch creators get extra flexibility.
- **Deny always beats Allow.**
- Use strict permissions on `main`/`release`, and flexible ones on feature branches.
