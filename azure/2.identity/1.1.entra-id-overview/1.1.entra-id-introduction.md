# ğŸªª **Microsoft Entra ID (Formerly Azure AD)**

## ğŸ“Œ **1. What is Entra ID?**

Microsoft **Entra ID** is Microsoftâ€™s **cloud-based Identity and Access Management (IAM)** platform.
It works as **Identity as a Service (IDaaS)** that:

- Stores identities (**users, groups, apps, devices**)
- **Authenticates** them (sign-in, MFA, passwordless)
- **Authorizes** them (what resources they can access)
- Integrates with **Azure resources, SaaS, custom apps**

ğŸ‘‰ Think of it as both:

- ğŸ¢ **Directory** (like a secure HR system for accounts)
- ğŸªª **Passport Office** (issues tokens so users/apps can prove who they are)

---

## ğŸ“Œ **2. Two Authentication Modes**

Hereâ€™s the key distinction ğŸ‘‡

### ğŸ”¹ **Mode 1 â€“ Authenticate Against Azure Resources (Management Plane)**

This is about **who can manage Azure itself**.

- You log in with Entra ID â†’ it decides your **role (RBAC)** on Azure.
- Examples: deploy VM, read Key Vault secrets, manage storage account.
- Tokens issued â†’ used against **Azure Resource Manager (ARM)** APIs.

ğŸ’¡ Flow:

---

<div align="center">

```mermaid
flowchart TD
  U[User/Service Principal/.etc] --> E[Entra ID]
  E -->|Access Token| ARM[Azure Resource Manager]
  ARM --> R[Azure Resource </br>e.g. VM, KeyVault]
```

</div>

---

### ğŸ”¹ **Mode 2 â€“ Authenticate Against Your Apps (Any Hosting)**

This is about **end-user or service access to business apps**.

- App is **registered** in Entra.
- App trusts Entra to authenticate users (via OIDC/SAML).
- Apps can be:

  - Azure-hosted (App Service, AKS)
  - AWS-hosted (EC2, Lambda)
  - On-prem (IIS, legacy)

- Entra issues tokens (ID/Access/Refresh) that your app consumes.

ğŸ’¡ Flow:

---

<div align="center">

```mermaid
sequenceDiagram
  participant U as User
  participant App as Your App (anywhere)
  participant E as Entra ID
  U->>App: Access request
  App->>E: Redirect to Entra login
  U->>E: Credentials + MFA
  E->>App: JWT (ID/Access Token)
  App->>U: Access granted âœ…
```

</div>

---

## ğŸ“Œ **3. Core Components**

| Component              | Description                                         |
| ---------------------- | --------------------------------------------------- |
| **Tenants**            | Your orgâ€™s isolated directory                       |
| **Users**              | Members, Guests, or External                        |
| **Groups**             | Collections for RBAC or app access                  |
| **Applications**       | Registered apps (SaaS/custom) with objects in Entra |
| **Service Principals** | App/automation identities (pipelines, Terraform)    |
| **Managed Identities** | Azure-managed SPs, no secrets needed                |
| **Devices**            | Registered devices (used in CA & compliance)        |
| **Roles & RBAC**       | Who can manage Azure or apps                        |

---

## ğŸ“Œ **4. Entra as IDaaS**

As an Identity-as-a-Service, Entra supports:

- **Protocols** â†’ OAuth2, OpenID Connect, SAML, SCIM
- **Federation** â†’ Google, Facebook, other IdPs
- **Single Sign-On (SSO)** â†’ 1000s of SaaS apps
- **Lifecycle mgmt** â†’ Auto-provision via SCIM
- **Governance** â†’ PIM, reviews, policy automation

ğŸ‘‰ So itâ€™s not just for Azure â†’ itâ€™s for **all apps, anywhere**.

---

## ğŸ“Œ **5. Real Examples**

### Example A â€“ Authenticate Against Azure Resource

- Alice (`alice@contoso.com`) logs into Azure Portal.
- Entra ID authenticates her + applies Conditional Access (require MFA).
- Sheâ€™s a **Contributor** on â€œDev Subscriptionâ€.
- She can deploy VMs and read Key Vault secrets, but not delete the subscription.

---

### Example B â€“ Authenticate Against Your App

- Bob visits `app.contoso.com` (hosted on AWS).
- App is registered in Entra ID.
- Bob redirected to Entra â†’ signs in with MFA.
- Entra issues ID + Access Token.
- Bobâ€™s app validates the token â†’ shows Bobâ€™s dashboard.

---

## ğŸ“Œ **6. Integration Points**

- **Azure Resource Management** â†’ via ARM + RBAC (Mode 1)
- **SaaS Apps (Salesforce, GitHub, ServiceNow)** â†’ SAML/OIDC (Mode 2)
- **Custom Apps** â†’ Register in Entra, protect with scopes/roles (Mode 2)
- **On-prem AD** â†’ Sync identities with Entra Connect

---

## ğŸ“Œ **7. Quick Comparison â€“ Azure vs Apps**

| Aspect           | Against Azure Resources ğŸ› ï¸          | Against Your Apps ğŸŒ            |
| ---------------- | ----------------------------------- | ------------------------------- |
| Token audience   | ARM APIs                            | Your App (OIDC/SAML endpoint)   |
| Example identity | Service Principal, Managed Identity | Human user or external customer |
| Role enforcement | Azure RBAC                          | App roles/claims/custom logic   |
| Hosting location | Only Azure resources                | Azure / AWS / On-Prem / SaaS    |

---

## ğŸ“Œ **8. Licensing**

- **Free** â†’ Basic identity + SSO
- **P1** â†’ Conditional Access, hybrid identity
- **P2** â†’ PIM, Identity Protection, advanced governance

---

## ğŸ§  **Key Takeaways**

- Entra ID = Microsoftâ€™s **cloud directory + Identity-as-a-Service**.
- Two big authentication modes:

  1. **Against Azure resources** â†’ who can manage cloud resources (via RBAC).
  2. **Against your apps** â†’ who can sign in to business apps (any hosting).

- Provides SSO, MFA, Conditional Access, Governance.
- Works like a **passport office** for your org â€” issues tokens that both Azure and your apps trust.
