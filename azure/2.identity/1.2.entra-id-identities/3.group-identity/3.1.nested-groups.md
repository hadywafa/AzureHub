# 👯 **Nested Groups**

**Microsoft Entra ID (formerly Azure AD) supports _nested groups_, meaning a group can contain both individual users and other groups as members. This allows for scalable, hierarchical access control.**

---

## 🧠 What Are Nested Groups in Entra ID?

Nested groups allow you to:

- **Add a group as a member of another group**.
- Automatically **inherit permissions** from the parent group.
- Simplify **RBAC**, licensing, and resource access across large organizations.

For example:

- `Group A` contains `Group B`
- `Group B` contains `User C`
  → `User C` inherits all permissions assigned to `Group A`.

---

## 🔐 Where Nested Groups Work

| Feature / Service                          | Nested Group Support                                     |
| ------------------------------------------ | -------------------------------------------------------- |
| **RBAC for Azure resources**               | ✅ Supported                                             |
| **Microsoft 365 apps (SharePoint, Teams)** | ✅ Supported                                             |
| **Conditional Access policies**            | ✅ Supported                                             |
| **Group-based licensing**                  | ✅ Supported                                             |
| **Dynamic groups**                         | ❌ Cannot nest dynamic groups                            |
| **Entra ID roles**                         | ⚠️ Limited—role assignments don’t traverse nested groups |
| **Entra Connect sync from on-prem AD**     | ✅ Supported (with caveats)                              |

---

## ⚠️ Limitations to Know

- **Maximum nesting depth**: Typically **5 levels** deep.
- **Azure RBAC does not support role inheritance through nested groups**
- **Group membership evaluation**: Some services may not immediately reflect nested membership—**token refresh or re-login** may be required.
- **Dynamic groups**: Cannot be nested or used as members of other groups.
- **Licensing**: Nested groups work for group-based licensing, but **license assignment may take time to propagate**.

---

## 🧠 Why Nested Groups Exist (Even Without RBAC Inheritance)

Nested groups help you:

### 1. **Simplify Group Management**

- Instead of adding 100 users to 10 different groups manually, you:
  - Create a team group (e.g., `DevTeam`)
  - Add `DevTeam` to `AppAccessGroup`, `LicenseGroup`, `PolicyGroup`
- Now, managing `DevTeam` automatically updates all downstream memberships.

### 2. **Enable Scalable Licensing**

- Assign Microsoft 365 or Azure licenses to a **parent group**.
- All users in nested child groups receive the license.
- This is supported in **group-based licensing**.

### 3. **Apply Conditional Access Policies**

- You can target a **parent group** with a policy (e.g., MFA required).
- All nested members are evaluated for that policy.
- Useful for **tiered access control** (e.g., contractors vs full-time staff).

### 4. **Integrate with External Apps**

- Many SaaS apps (e.g., Salesforce, ServiceNow) respect nested group logic.
- You can map Entra groups to app roles more cleanly.

---

> **⚠️ Why RBAC Doesn’t Support It**  
> Azure RBAC evaluates **direct group membership only** for performance and security clarity:
>
> - Avoids ambiguity in access audits.
> - Keeps token evaluation lightweight.
> - Forces **explicit role assignments**, which is safer in multi-tenant environments.

---

> 💭 Think of nested groups like **folders in a permissions system**:
>
> - You organize users into folders (groups), and folders into categories (nested groups).
> - But access to a file (resource) depends on **which folder you assign**, not the hierarchy.

---

## 🧪 Real-World Example

Let’s say you’re managing access to a secure Azure Key Vault:

- You assign `Group A` to the Key Vault’s RBAC role.
- You add `Group B` to `Group A`.
- You add `User C` to `Group B`.

→ `User C` now has access to the Key Vault, even though they’re not directly in `Group A`.

This is especially useful for **multi-team environments**, **regional access control**, or **tiered permissions**.

---

Would you like a PowerShell or CLI example to create nested groups and assign RBAC roles? Or a diagram showing how nested group membership flows into Azure resource access?

## 📚 References

- [Microsoft Docs – Directory service limits](https://learn.microsoft.com/en-us/entra/identity/users/directory-service-limits-restrictions),
- [DynamicGroup.net – Nested AD groups in Entra ID](https://www.dynamicgroup.net/en/news/synchronize-nested-ad-groups-in-entra-id/)
