# üñ•Ô∏è Azure Pipelines: **Server Jobs**

## üìò What is a Server Job?

> A **Server Job** runs on the **Azure DevOps server itself**, not on any agent machine.
>
> It‚Äôs used for tasks that don‚Äôt need compute resources, like waiting for approval, sending emails, or calling external systems.

---

## üß† Core Characteristics

| Property               | Value                                  |
| ---------------------- | -------------------------------------- |
| Runs on agent?         | ‚ùå No agent used                       |
| Consumes parallel job? | ‚ùå No (FREE)                           |
| Used for               | Approvals, gates, delays, REST calls   |
| Can run tasks?         | ‚úÖ But only **server-supported tasks** |
| Timeout                | 60 days max                            |

---

## üß© When to Use Server Jobs?

- ‚úÖ Manual Approvals
- ‚úÖ Wait timers
- ‚úÖ External system checks (like REST API calls to status endpoints)
- ‚úÖ Gates (pre/post deployment validations)
- ‚úÖ Sending emails or triggering webhooks
- ‚úÖ Slack/Teams/ServiceNow integrations
- ‚úÖ Polling readiness of external services

---

## ‚öôÔ∏è YAML Example: Server Job for Manual Approval

```yaml
jobs:
  - deployment: ApprovalGate
    displayName: "üõë Wait for Manual Approval"
    environment: "prod-env"
    strategy:
      runOnce:
        deploy:
          steps:
            - task: ManualValidation@0
              inputs:
                instructions: "Please approve this step before deploying to production."
                onTimeout: reject
                timeout: "1d"
```

‚úÖ **Notice:** This job doesn't require any agent or pool!

---

## üìé Example: Use `delay` Task in Server Job

```yaml
jobs:
  - job: WaitStep
    displayName: "‚è≥ Wait 2 minutes before proceeding"
    pool: server
    steps:
      - task: Delay@1
        inputs:
          delayForMinutes: 2
```

This lets you **introduce intentional delays** without consuming agents.

---

## üì§ Example: REST API call to external system

```yaml
jobs:
  - job: PingStatusAPI
    displayName: "üì° Check Status from External API"
    pool: server
    steps:
      - task: HttpRequest@2
        inputs:
          connectedServiceName: "MyServiceConnection"
          method: GET
          urlSuffix: "/status"
```

This allows **pre/post deployment validation** against your own systems, safely and cheaply.

---

## üí° Pool Type: `server`

```yaml
pool: server
```

That‚Äôs it. No agent is involved. All steps **must be supported by the Azure DevOps server**, which excludes things like running shell scripts.

---

## üî• Limitations

| Limitation              | Detail                                      |
| ----------------------- | ------------------------------------------- |
| ‚ùå No scripts           | Can't run Bash, PowerShell, etc.            |
| ‚ùå No file manipulation | No access to local or remote files          |
| ‚úÖ Safe but limited     | Only works with pre-approved built-in tasks |
| üß© Works best           | Inside environments or gates                |

---

## ü§ñ Used Internally in Deployment Gates

Azure DevOps uses server jobs for:

- **Pre-deployment Gates**
- **Post-deployment Gates**
- **Approvals**
- **Delays**
- **External API health checks**

> They don‚Äôt consume agents, making them _very cost-efficient._

---

## ‚úÖ Summary Table

| Feature                | Server Job                         |
| ---------------------- | ---------------------------------- |
| Agent used?            | ‚ùå No                              |
| Consumes parallel job? | ‚ùå No                              |
| Can run scripts?       | ‚ùå No                              |
| Used for               | Approvals, delays, external checks |
| Timeout                | 60 days                            |
| Cost                   | Free                               |
