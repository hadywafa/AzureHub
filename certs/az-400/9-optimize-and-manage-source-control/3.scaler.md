# âš™ï¸ Scalar: Optimizing Git for Large Repositories

> **[Scalar](https://github.com/microsoft/scalar)**, a Microsoft-backed tool designed to optimize Git performance on **very large monorepos**.

---

## ğŸ¯ Why Scalar Exists

### âŒ Problem with Large Repos:

- Git clones **everything** by default (all branches, full history)
- ğŸ¢ Slows down dev machines with large codebases
- ğŸ§  Developers might only need a **tiny part of the repo** (a few folders)

### âœ… Solution: Scalar

- Improves Git with:

  - Partial clone
  - Sparse checkout
  - Background maintenance

- Now integrated into **core Git â‰¥ v2.30+** with these features:

  - `git clone --filter`
  - `git sparse-checkout`
  - `git maintenance`

---

## ğŸ› ï¸ Scalar in Action (Diagram 1 + 2 + 3 Breakdown)

### ğŸ”¹ Scalar Basics

![1753722028395](image/3.scaler/1753722028395.png)

Commands used:

```bash
scalar clone <url>     # Clone optimized repo (sets config + sparse)
git clone --filter=blob:none  # Partial clone (downloads files on-demand)
git sparse-checkout init --cone
git maintenance start
```

ğŸ” This does the following:

- Only fetches minimal data
- Sets up **on-demand file loading** (like lazy-loading)
- Starts Git background maintenance to auto-optimize

âœ… **Scalar clones quickly**, even for huge monorepos.

---

### ğŸ”¹ Selective Folder Checkout

![1753722046056](image/3.scaler/1753722046056.png)

---

```bash
cd repo
cd src
git sparse-checkout set Pages
```

âœ… This tells Git:

> â€œI only want the `Pages` folder in my working directory.â€

ğŸ‘©â€ğŸ’» Result:

- You **see only relevant folders/files**
- Other content stays in Gitâ€™s database (not in working directory)
- Ideal for huge repos with thousands of folders

---

## ğŸ§¬ Scalar + Azure DevOps or GitHub

> Scalar works with **Azure DevOps**, **GitHub**, and **GitHub Enterprise**  
> It helps developers only **clone what's needed** from the monorepo  
> Background Git maintenance (gc, fetch pruning, etc.) runs automatically

![1753721775457](image/3.scaler/1753721775457.png)

---

## ğŸ”‘ Key Features of Scalar

| Feature                  | Description                                                                  |
| ------------------------ | ---------------------------------------------------------------------------- |
| ğŸ§  Smart Cloning         | Uses `--filter=blob:none` to avoid downloading all file contents immediately |
| ğŸ§¹ Git Maintenance       | Runs background maintenance tasks like garbage collection                    |
| ğŸ“ Sparse Checkout       | Developers can select specific folders to work on                            |
| ğŸš€ Fast Repo Startup     | Works great for huge codebases (e.g. OS-level)                               |
| ğŸ§‘â€ğŸ’» Developer-Friendly | Looks and behaves like Git â€” you just get performance for free!              |

---

## âœ… Scalar vs Vanilla Git

| Action                  | Git (default)          | Git with Scalar Setup                           |
| ----------------------- | ---------------------- | ----------------------------------------------- |
| Clone whole repo        | ğŸš« Slow for big repos  | âœ… Fast â€” only metadata + shallow blobs         |
| View only part of repo  | âŒ Needs full checkout | âœ… Use sparse-checkout to see only subfolders   |
| Background optimization | âŒ Manual `gc` needed  | âœ… Git runs `gc` and cleanups in the background |
| Great for monorepos?    | âŒ Not practical       | âœ… Optimized for them                           |

---

## ğŸš€ Example: Scalar Commands Cheat Sheet

```bash
# ğŸ§  Clone optimized repo
scalar clone https://dev.azure.com/org/project/_git/monorepo

# ğŸ§¼ Enable background maintenance
git maintenance start

# ğŸ“ Use sparse checkout to get only needed folders
git sparse-checkout init --cone
git sparse-checkout set src/pages
```

---

## ğŸ¤” When to Use Scalar?

| Scenario                           | Use Scalar?   |
| ---------------------------------- | ------------- |
| Huge monorepo (10k+ files)         | âœ… Yes        |
| Azure DevOps or GitHub repo        | âœ… Yes        |
| Small project                      | âŒ Not needed |
| Working on full repo (not partial) | âš ï¸ Optional   |
| Want faster Git performance        | âœ… Yes        |

---

## ğŸ“¦ Summary

> Scalar = **Git on steroids** for large codebases.

âœ… It gives you:

- Partial clones
- Sparse checkouts
- Background maintenance
- Git speedup without changing your workflow

And as of Git v2.30+, you can use most of its benefits **without installing Scalar**, just by using:

```bash
git clone --filter=blob:none
git sparse-checkout ...
git maintenance start
```
