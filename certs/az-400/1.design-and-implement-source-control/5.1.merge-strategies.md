# ğŸ§  Merge Strategies in Azure DevOps

> "How do we combine code from one branch into another?"  
> Thatâ€™s the art (and science) of _merge strategies_ ğŸ”„

---

<div align="center">
    <img src="images/merge_types.gif" alt="Merge Types" style="width: 60%; border-radius: 10px;">
</div>

---

## âš™ï¸ What Are Merge Strategies?

When you **merge a Pull Request (PR)** in Azure DevOps, you decide how the commits will be recorded in the target branch (`main`, `develop`, etc).

> The strategy you pick affects:
>
> - Git history
> - Commit visibility
> - Traceability (blame, revert, bisect)
> - How clean or messy your logs are

---

## ğŸ”¢ All 4 Merge Strategies in Azure DevOps

| Strategy                        | History                    | Keeps Commits | Auto Mergeable | Best For                        |
| ------------------------------- | -------------------------- | ------------- | -------------- | ------------------------------- |
| ğŸ”€ Merge Commit                 | ğŸŒ€ Full history            | âœ… Yes        | âœ… Yes         | Auditable logs, large teams     |
| ğŸ“¦ Squash                       | ğŸ§¼ Single commit           | âŒ No         | âœ… Yes         | Clean logs, feature-level PRs   |
| ğŸ“ Rebase & Fast-Forward        | ğŸ“ˆ Linear only             | âœ… Yes        | âŒ Manual      | OSS, advanced Git workflows     |
| âœ‚ï¸ Rebase + Merge (Semi-linear) | ğŸ§¬ Hybrid (rebase + merge) | âœ… Yes        | âŒ Manual      | Keeps clean logs _and_ PR trace |

---

## ğŸ“Œ Perquisites

### ğŸ›¬ Fast-Forward Merge (FF)

**What It Is:**

If the target branch (e.g. `main`) is **directly behind** the source branch, Git just **moves the pointer forward**. No new commit is created.

**Visual:**

```bash
Before:
main:     A --- B
                 \
feature:          C --- D


After fast-forward:
main:     A --- B --- C --- D
```

> No merge commit, just a pointer shift.

**When Possible:**

- Target branch has **no new commits** since the feature branch split.
- Clean linear history.

---

### ğŸƒğŸ»â€â¡ï¸ Rebase

**What It Is:**

Rewrites the feature branch to **replay its commits on top** of the latest `main`.

**Visual:**

```bash
Before:
main:     A --- B --- C
                 \
feature:           D --- E

After rebase:
main:     A --- B --- C
                       \
feature:                D --- E
```

> Commit hashes change â€” itâ€™s rewriting history!

**Use With Caution:**

- Don't rebase shared branches.
- Good for cleaning up local history before PR.

---

## ğŸ§© Azure DevOps Merge Types

1. 1ï¸âƒ£ **Merge** (No Fast-Forward) Commit
2. 2ï¸âƒ£ **Squash** Commit
3. 3ï¸âƒ£ **Rebase** and **Fast-Forward**
4. 4ï¸âƒ£ **Semi-Linear** (**Rebase** + **Merge**)

---

## 1ï¸âƒ£ Merge Commit (aka No Fast-Forward Merge)

### ğŸ“Œ What It Does:

Adds a **new commit** that has **two parents**: one from the **source branch** and one from the **target branch**.


### ğŸ§± Visual:

```bash
Before:
main:     A --- B
                 \
feature:          C ----- D


After:
main:     A --- B --------- `E`
                 \         /
feature:          C ----- D
```

> ğŸ§¾ Merge commit E has **2 parents**: B and D

---

### âœ… Use When:

- You want a **clear record** of the merge
- Teams rely on Git audit trail or revert PR functionality

### ğŸ”§ How to Enable:

1. In Azure DevOps PR:

   - Set **Merge type**: `Merge (no fast-forward)`

2. Repo policy: enable `Allow merge commits`

---

## 2ï¸âƒ£ Squash Commit Merge

### ğŸ“Œ What It Does:

**Squashes all commits** from the feature branch into a **single commit** on `main`.

### ğŸ§± Visual:

```bash
Before:
main:     A --- B
                 \
feature:          C ----- D ----- E

After:
main:     A --- B --------------- `F`
                 \
feature:          C ----- D ----- E
```

> ğŸ“Œ No merge commit, just a single combined commit.

---

### âœ… Use When:

- You want clean Git history
- Feature branches are small/atomic
- CI/CD logs should stay tidy

### ğŸ”§ How to Enable:

1. In Azure DevOps PR:

   - Set **Merge type**: `Squash commit`

2. Repo policy: enable `Allow squash merge`

---

## 3ï¸âƒ£ Rebase and Fast-Forward

### ğŸ“Œ What It Does:

- Rebases your commits on top of the latest `main`
- Then **fast-forwards** the target branch

### ğŸ§± Visual:

```bash
Before:
main:     A --- B --- C
                 \
feature:           D --- E

After:
main:     A --- B --- C
                       \
feature:                 D --- E


After:
main:     A --- B --- C  --- D --- E
```

> ğŸ“Œ No merge commit â€” just rebased commits applied on top.

---

### âœ… Use When:

- You want clean, linear history
- Team is confident with rebasing

### ğŸ”§ How to Enable:

1. In Azure DevOps PR:

   - Set **Merge type**: `Rebase and fast-forward`

2. Repo policy: enable `Allow rebase and fast-forward`

---

## 4ï¸âƒ£ Semi-Linear Merge (Rebase + Merge Commit)

### ğŸ“Œ What It Does:

- Rebases your branch on top of `main`
- Then creates a **merge commit**

ğŸ§± Visual:

```bash
main:     A --- B --- C
                 \
feature:           D --- E

After semi-linear:
main:     A --- B --- C
                       \
feature:                 D --- E

After semi-linear:
main:     A --- B --- C  ------ `M`
                       \        /
feature:                 D --- E
```

> ğŸ§¾ Merge commit `M` has 2 parents: D' and B

---

### âœ… Use When:

- You want **both** clean commit history **and** merge commit for traceability
- Hybrid teams using automated pipelines or revert-based rollbacks

### ğŸ”§ How to Enable:

1. In Azure DevOps PR:

   - Set **Merge type**: `Semi-linear merge`

2. Repo policy: enable `Allow semi-linear merge`

---

## ğŸ” Summary Table

| Merge Strategy               | Creates Merge Commit | Keeps All Commits | Clean History  | Requires Rebase | Ideal For                     |
| ---------------------------- | -------------------- | ----------------- | -------------- | --------------- | ----------------------------- |
| Merge (no fast-forward)      | âœ… Yes               | âœ… Yes            | âŒ No          | âŒ No           | Full audit trail              |
| Squash Commit                | âŒ No                | âŒ No (1 commit)  | âœ… Yes         | âŒ No           | Simpler logs, atomic features |
| Rebase + Fast-Forward        | âŒ No                | âœ… Yes            | âœ… Ultra clean | âœ… Yes          | Expert teams, linear history  |
| Semi-Linear (Rebase + Merge) | âœ… Yes               | âœ… Yes (rebased)  | âœ… Clean       | âœ… Yes          | CI-friendly + audit-friendly  |

---

## ğŸ”§ Azure DevOps Policy Setup (Recommended)

Go to:
**Project Settings â†’ Repos â†’ \[Repo] â†’ Policies â†’ Pull Request Merge Types**

| Suggested Setup for Most Teams  |
| ------------------------------- |
| âœ… Allow Merge Commit           |
| âœ… Allow Squash Commit          |
| âœ… Allow Semi-linear (optional) |
| âŒ Disable plain Rebase + FF    |
