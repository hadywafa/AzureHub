# ğŸ“ Azure Repos

> Version control system in Azure DevOps (ADO) supporting both `Git` and `TFVC` â€” choose your style, your speed.

---

## ğŸ§­ What is Azure Repos?

**Azure Repos** is the **source code management system** in **Azure DevOps Services (ADO)**.

âœ… It lets teams:

- Track code changes
- Collaborate through branching and pull requests
- Manage CI/CD triggers
- Control access and history

It supports **two version control types**:

| Type     | Description                              |
| -------- | ---------------------------------------- |
| **Git**  | Distributed VCS (modern, popular)        |
| **TFVC** | Centralized VCS (older, Microsoft-style) |

---

## âš”ï¸ Git vs TFVC (Team Foundation Version Control)

| Feature               | **Git (Distributed)**           | **TFVC (Centralized)**            |
| --------------------- | ------------------------------- | --------------------------------- |
| ğŸ—ƒï¸ History            | Stored locally + remotely       | Only on server                    |
| ğŸ“¦ Branching          | Lightweight, fast               | Heavy, slower                     |
| ğŸ§ª Offline work       | Yes (full repo)                 | No (requires server)              |
| ğŸ§  Commit granularity | Multiple small commits          | Usually 1 big change per check-in |
| â›“ï¸ Merge model        | Merge â†’ Pull Request            | Check-in with locks               |
| ğŸ”¥ Popularity         | Widely used (GitHub, Bitbucket) | Legacy, internal MS use           |

âœ… **Recommendation**: Always use **Git** unless youâ€™re maintaining old code in TFVC.

---

## âœ… 1. Features of Azure Repos

Here's what makes Azure Repos powerful for modern software teams:

---

<div align="center">
  <img src="images/az-repo-features.png" alt="Azure Repos Features" style="width: 100%; border-radius: 10px;border: solid">
</div>

---

### âœ¨ 1.1 Started with Enterprise

- Built natively into Azure DevOps (ADO) for **large orgs and regulated teams**
- Enterprise-grade security, compliance, and audit logging out-of-the-box

### ğŸŒ 1.2 Git and TFVC Source Control

- Supports both:

  - ğŸ§  **Git**: distributed version control (recommended)
  - ğŸ¢ **TFVC**: Team Foundation Version Control (centralized, legacy)

### ğŸ”— 1.3 Integrated with Azure DevOps Services

- Full integration with:

  - âœ… Boards (work items, linking PRs to tasks)
  - âœ… Pipelines (CI/CD triggers)
  - âœ… Artifacts (dependencies)
  - âœ… Test Plans and Dashboards

### ğŸ¤ 1.4 Collaborative Source Control

- Advanced code collaboration:

  - Pull Requests with required reviewers
  - Built-in policies and auto-merge
  - Threaded comments, code suggestions
  - Merge conflict resolution in-browser

### ğŸ’¾ 1.5 Supports Large Files (Git LFS)

- Integrates with **Git LFS** for tracking large binaries (media, datasets, CAD files)

### ğŸ“‚ 1.6 Project-Scoped Repos

- Every **project** in Azure DevOps can have **multiple Git repos**
- Easy to separate services (e.g., `store-ui`, `store-api`) within one project

## ğŸ—ï¸ 2. Azure Repos Architecture

Azure Repos is part of the Azure DevOps hierarchy:

```ini
Azure DevOps
â””â”€â”€ Organization: Aus-E-Mart
    â”œâ”€â”€ Project: Stores
    â”‚   â”œâ”€â”€ Repo: store-web-ui
    â”‚   â””â”€â”€ Repo: store-web-api
    â””â”€â”€ Project: Public
        â””â”€â”€ Repo: pub-store-api
```

---

<div align="center">
  <img src="images/az-repo-architecture.png" alt="Azure Repos Architecture" style="width: 100%; border-radius: 10px;border: solid">
</div>

---

### ğŸ¢ 2.1 Organization

- Top-level container
- Managed under **Microsoft Entra ID (Azure AD)** for identity
- Controls **billing, users, licensing**

Example: `https://dev.azure.com/aus-e-mart`

---

### ğŸ“‚ 2.2 Project

Each **Organization** can contain multiple **Projects**.

- Represents a software system or business unit
- Has:

  - Azure Repos
  - Boards
  - Pipelines
  - Artifacts

Project examples: `Stores`, `Public`

---

### ğŸ“ 2.3 Repository (Repo)

Inside a project, you can have one or more **Git repositories**:

- Each repo:

  - Has branches, history, commits, tags
  - Supports pull requests and Git LFS

- You clone/push via HTTPS or SSH:

```ini
HTTPS: https://dev.azure.com/org/project/_git/repo
SSH:   git@ssh.dev.azure.com:v3/org/project/repo
```

ğŸ”§ You choose the protocol that fits your auth setup.

---

### âš™ï¸ 2.4 Git Protocols in Azure Repos

| Protocol  | URL Example                                | Auth Supported  |
| --------- | ------------------------------------------ | --------------- |
| **HTTPS** | `https://dev.azure.com/org/proj/_git/repo` | PAT, OAuth, GCM |
| **SSH**   | `git@ssh.dev.azure.com:v3/org/proj/repo`   | SSH Keys        |

---

## ğŸ” 3. Access Control in Azure Repos

Azure DevOps uses **RBAC (Role-Based Access Control)** + **Microsoft Entra ID (Azure AD)** identities.

---

<div align="center">
  <img src="images/az-repo-access-control.png" alt="Azure Repo Access Control" style="width: 100%; border-radius: 10px;border: solid">
</div>

---

### ğŸ‘¥ 3.1 Identity Sources

- **Microsoft Entra ID (Azure AD)**:

  - Users (Rick, Summer)
  - Groups (Developers, Admins)

- **Access Tokens** (for automation)

---

### ğŸ” 3.2 Authentication Methods

| Method                             | Use Case                             | Login Style            |
| ---------------------------------- | ------------------------------------ | ---------------------- |
| **ğŸ”’ OAuth**                       | Devs with Microsoft login (SSO, MFA) | Browser + GCM          |
| **ğŸ§¾ PAT (Personal Access Token)** | CLI, automation                      | Token used as password |
| **ğŸ”‘ SSH Key**                     | Secure Git access via SSH            | No password prompts    |
| **ğŸ¤– Service Principals**          | App-to-repo automation               | Used in Pipelines      |

---

### ğŸ”‘ 3.3 Permissions Model

| Scope            | Description                                              |
| ---------------- | -------------------------------------------------------- |
| **Organization** | Admins can control users, billing, policies              |
| **Project**      | Control contributor access, boards, pipelines            |
| **Repo**         | Grant granular Git rights (read, contribute, force-push) |

---

### ğŸ›‚ 3.4 Repo-Level Permissions

| Permission             | Purpose                        |
| ---------------------- | ------------------------------ |
| **Read**               | View code, branches            |
| **Contribute**         | Push commits                   |
| **Force Push**         | Overwrite history              |
| **Create Branch/Tag**  | Add refs                       |
| **Manage Permissions** | Set othersâ€™ access             |
| **Bypass PR policies** | Merge without PRs (dangerous!) |

---

### ğŸ§° 3.5 Assigning Permissions

- Go to: `Project Settings â†’ Repos â†’ Security`
- Assign users or groups to roles like:

  - **Project Administrators**
  - **Contributors**
  - **Readers**
  - Or create custom security roles

---

### ğŸ§  Visual Recap: Access Flow

ğŸ“¸ From your diagram:

```text
Azure AD Users:
- Rick â†’ SSH Auth
- Summer â†’ PAT Auth
â†“
Permissions via Project Security Group
â†“
Access Git Repos (store-web-ui, store-web-api)
```

---

## âœ… Summary

| Layer                | Key Points                                             |
| -------------------- | ------------------------------------------------------ |
| **Azure Repos**      | Git-based source control inside Azure DevOps           |
| **Features**         | Git+TFVC, PRs, Git LFS, enterprise-grade integration   |
| **Architecture**     | Org â†’ Project â†’ Repos, scoped and manageable           |
| **Access Control**   | RBAC with Entra ID, PATs, OAuth, SSH, service accounts |
| **Protocol Support** | HTTPS (GCM, PAT), SSH (SSH Keys)                       |
